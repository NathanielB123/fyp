{-# OPTIONS --prop --rewriting --show-irrelevant #-}

open import Utils
open import Utils.IdExtras

open import Dependent.SCBool.Syntax
open import Dependent.SCBool.MutualInd

-- First attempt at "Model.agda". Unfortunately, Agda's termination checker is
-- not happy.
module Dependent.SCBool.ModelOld where

âŸ¦CtxâŸ§ : Setâ‚
âŸ¦CtxâŸ§ = Set

âŸ¦TyâŸ§ : âŸ¦CtxâŸ§ â†’ Setâ‚
âŸ¦TyâŸ§ Î“ = Î“ â†’ Set

âŸ¦TmâŸ§ : âˆ€ Î“ â†’ âŸ¦TyâŸ§ Î“ â†’ Set
âŸ¦TmâŸ§ Î“ A = âˆ€ Ï â†’ A Ï

âŸ¦TmsâŸ§ : âŸ¦CtxâŸ§ â†’ âŸ¦CtxâŸ§ â†’ Set
âŸ¦TmsâŸ§ Î” Î“ = Î” â†’ Î“

variable
  âŸ¦Î“âŸ§ âŸ¦Î”âŸ§ âŸ¦Î“â‚âŸ§ âŸ¦Î“â‚‚âŸ§ âŸ¦Î”â‚âŸ§ âŸ¦Î”â‚‚âŸ§   : âŸ¦CtxâŸ§
  âŸ¦AâŸ§ âŸ¦BâŸ§ âŸ¦Aâ‚âŸ§ âŸ¦Aâ‚‚âŸ§ âŸ¦Bâ‚âŸ§ âŸ¦Bâ‚‚âŸ§   : âŸ¦TyâŸ§ âŸ¦Î“âŸ§ 
  âŸ¦tâŸ§ âŸ¦tâ‚âŸ§ âŸ¦tâ‚‚âŸ§ âŸ¦uâ‚âŸ§ âŸ¦uâ‚‚âŸ§ âŸ¦vâ‚âŸ§ âŸ¦vâ‚‚âŸ§ : âŸ¦TmâŸ§ âŸ¦Î“âŸ§ âŸ¦AâŸ§
  âŸ¦Î´â‚âŸ§ âŸ¦Î´â‚‚âŸ§                     : âŸ¦TmsâŸ§ âŸ¦Î”âŸ§ âŸ¦Î“âŸ§

Tyâ‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§ â†’ âŸ¦TyâŸ§ âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦TyâŸ§ âŸ¦Î“â‚‚âŸ§
Tyâ‰¡ refl = refl

Tmâ‰¡ : âˆ€ Î“â‰¡ â†’ âˆ€ (Aâ‰¡ : âŸ¦Aâ‚âŸ§ â‰¡[ Tyâ‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦Aâ‚‚âŸ§) 
    â†’ âŸ¦TmâŸ§ âŸ¦Î“â‚âŸ§ âŸ¦Aâ‚âŸ§ â‰¡á´¾ âŸ¦TmâŸ§ âŸ¦Î“â‚‚âŸ§ âŸ¦Aâ‚‚âŸ§
Tmâ‰¡ refl refl = refl

Tmsâ‰¡ : âŸ¦Î”â‚âŸ§ â‰¡á´¾ âŸ¦Î”â‚‚âŸ§ â†’ âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§ â†’ âŸ¦TmsâŸ§ âŸ¦Î”â‚âŸ§ âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦TmsâŸ§ âŸ¦Î”â‚‚âŸ§ âŸ¦Î“â‚‚âŸ§
Tmsâ‰¡ refl refl = refl

variable
  Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§
  Aâ‰¡ : âŸ¦Aâ‚âŸ§ â‰¡[ Tyâ‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦Aâ‚‚âŸ§


âŸ¦,âŸ§ = Î£

,â‰¡ : âˆ€ Î“â‰¡ â†’ âŸ¦Aâ‚âŸ§ â‰¡[ Tyâ‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦Aâ‚‚âŸ§ â†’ âŸ¦,âŸ§ âŸ¦Î“â‚âŸ§ âŸ¦Aâ‚âŸ§ â‰¡á´¾ âŸ¦,âŸ§ âŸ¦Î“â‚‚âŸ§ âŸ¦Aâ‚‚âŸ§ 
,â‰¡ refl refl = refl

âŸ¦Î âŸ§ : âˆ€ âŸ¦AâŸ§ â†’ âŸ¦TyâŸ§ (âŸ¦,âŸ§ âŸ¦Î“âŸ§ âŸ¦AâŸ§) â†’ âŸ¦TyâŸ§ âŸ¦Î“âŸ§
âŸ¦Î âŸ§ âŸ¦AâŸ§ âŸ¦BâŸ§ = Î» Ï â†’ âˆ€ x â†’ âŸ¦BâŸ§ (Ï Î£, x)

âŸ¦ğ”¹âŸ§ : âŸ¦TyâŸ§ âŸ¦Î“âŸ§
âŸ¦ğ”¹âŸ§ = Î» _ â†’ Bool

âŸ¦,>rwâŸ§ : âˆ€ âŸ¦Î“âŸ§ â†’ âŸ¦TmâŸ§ âŸ¦Î“âŸ§ âŸ¦ğ”¹âŸ§ â†’ Bool â†’ âŸ¦CtxâŸ§
âŸ¦,>rwâŸ§ âŸ¦Î“âŸ§ âŸ¦tâŸ§ b = Î£ âŸ¦Î“âŸ§ (Î» Ï â†’ Box (âŸ¦tâŸ§ Ï â‰¡á´¾ b))

ğ”¹â‰¡ : âˆ€ (Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§) â†’ âŸ¦ğ”¹âŸ§ â‰¡[ Tyâ‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦ğ”¹âŸ§
ğ”¹â‰¡ refl = refl

,>rwâ‰¡ : âˆ€ (Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§) â†’ âŸ¦tâ‚âŸ§ â‰¡[ Tmâ‰¡ Î“â‰¡ (ğ”¹â‰¡ Î“â‰¡) ]â‰¡á´¾ âŸ¦tâ‚‚âŸ§ 
      â†’ âŸ¦,>rwâŸ§ âŸ¦Î“â‚âŸ§ âŸ¦tâ‚âŸ§ b â‰¡á´¾ âŸ¦,>rwâŸ§ âŸ¦Î“â‚‚âŸ§ âŸ¦tâ‚‚âŸ§ b
,>rwâ‰¡ refl refl = refl

Î â‰¡ : âˆ€ Î“â‰¡ Aâ‰¡ â†’ âŸ¦Bâ‚âŸ§ â‰¡[ Tyâ‰¡ (,â‰¡ Î“â‰¡ Aâ‰¡) ]â‰¡á´¾ âŸ¦Bâ‚‚âŸ§
     â†’ âŸ¦Î âŸ§ âŸ¦Aâ‚âŸ§ âŸ¦Bâ‚âŸ§ â‰¡[ Tyâ‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦Î âŸ§ âŸ¦Aâ‚‚âŸ§ âŸ¦Bâ‚‚âŸ§
Î â‰¡ refl refl refl = refl

âŸ¦TTâŸ§ : âŸ¦TmâŸ§ âŸ¦Î“âŸ§ âŸ¦ğ”¹âŸ§
âŸ¦TTâŸ§ _ = true

TTâ‰¡ : (Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§) â†’ âŸ¦TTâŸ§ â‰¡[ Tmâ‰¡ Î“â‰¡ (ğ”¹â‰¡ Î“â‰¡) ]â‰¡á´¾ âŸ¦TTâŸ§ 
TTâ‰¡ refl = refl

âŸ¦FFâŸ§ : âŸ¦TmâŸ§ âŸ¦Î“âŸ§ âŸ¦ğ”¹âŸ§
âŸ¦FFâŸ§ _ = false

FFâ‰¡ : (Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§) â†’ âŸ¦FFâŸ§ â‰¡[ Tmâ‰¡ Î“â‰¡ (ğ”¹â‰¡ Î“â‰¡) ]â‰¡á´¾ âŸ¦FFâŸ§ 
FFâ‰¡ refl = refl

âŸ¦[]TâŸ§ : âŸ¦TyâŸ§ âŸ¦Î“âŸ§ â†’ âŸ¦TmsâŸ§ âŸ¦Î”âŸ§ âŸ¦Î“âŸ§ â†’ âŸ¦TyâŸ§ âŸ¦Î”âŸ§
âŸ¦[]TâŸ§ âŸ¦AâŸ§ âŸ¦Î´âŸ§ Ï = âŸ¦AâŸ§ (âŸ¦Î´âŸ§ Ï)

[]Tâ‰¡ : âˆ€ Î“â‰¡ Î”â‰¡ â†’ âŸ¦Aâ‚âŸ§ â‰¡[ Tyâ‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦Aâ‚‚âŸ§ â†’ âŸ¦Î´â‚âŸ§ â‰¡[ Tmsâ‰¡ Î”â‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦Î´â‚‚âŸ§
     â†’ âŸ¦[]TâŸ§ âŸ¦Aâ‚âŸ§ âŸ¦Î´â‚âŸ§ â‰¡[ Tyâ‰¡ Î”â‰¡ ]â‰¡á´¾ âŸ¦[]TâŸ§ âŸ¦Aâ‚‚âŸ§ âŸ¦Î´â‚‚âŸ§
[]Tâ‰¡ refl refl refl refl = refl

âŸ¦Ï€â‚rwâŸ§ : âŸ¦TmsâŸ§ (âŸ¦,>rwâŸ§ âŸ¦Î“âŸ§ âŸ¦tâŸ§ b) âŸ¦Î“âŸ§
âŸ¦Ï€â‚rwâŸ§ = fst

Ï€â‚rwâ‰¡ : âˆ€ (Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§) (tâ‰¡ : âŸ¦tâ‚âŸ§ â‰¡[ Tmâ‰¡ Î“â‰¡ (ğ”¹â‰¡ Î“â‰¡) ]â‰¡á´¾ âŸ¦tâ‚‚âŸ§) 
      â†’ âŸ¦Ï€â‚rwâŸ§ â‰¡[ Tmsâ‰¡ (,>rwâ‰¡ {b = b} Î“â‰¡ tâ‰¡) Î“â‰¡ ]â‰¡á´¾ âŸ¦Ï€â‚rwâŸ§
Ï€â‚rwâ‰¡ refl refl = refl

âŸ¦ifâŸ§ : âˆ€ âŸ¦tâŸ§ 
     â†’ âŸ¦TmâŸ§ (âŸ¦,>rwâŸ§ âŸ¦Î“âŸ§ âŸ¦tâŸ§ true)  (âŸ¦[]TâŸ§ âŸ¦AâŸ§ âŸ¦Ï€â‚rwâŸ§)
     â†’ âŸ¦TmâŸ§ (âŸ¦,>rwâŸ§ âŸ¦Î“âŸ§ âŸ¦tâŸ§ false) (âŸ¦[]TâŸ§ âŸ¦AâŸ§ âŸ¦Ï€â‚rwâŸ§)
     â†’ âŸ¦TmâŸ§ âŸ¦Î“âŸ§ âŸ¦AâŸ§
âŸ¦ifâŸ§ âŸ¦tâŸ§ âŸ¦uâŸ§ âŸ¦vâŸ§ = Î» Ï â†’ Bool-splitá´¾ (âŸ¦tâŸ§ Ï) (Î» t~ â†’ âŸ¦uâŸ§ (Ï Î£, box t~)) 
                                             (Î» t~ â†’ âŸ¦vâŸ§ (Ï Î£, box t~))

ifâ‰¡ : âˆ€ (Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§) (Aâ‰¡ : âŸ¦Aâ‚âŸ§ â‰¡[ Tyâ‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦Aâ‚‚âŸ§) 
        (tâ‰¡ : âŸ¦tâ‚âŸ§ â‰¡[ Tmâ‰¡ Î“â‰¡ (ğ”¹â‰¡ Î“â‰¡) ]â‰¡á´¾ âŸ¦tâ‚‚âŸ§)
    â†’ âŸ¦uâ‚âŸ§ â‰¡[ Tmâ‰¡ (,>rwâ‰¡ Î“â‰¡ tâ‰¡) ([]Tâ‰¡ Î“â‰¡ (,>rwâ‰¡ Î“â‰¡ tâ‰¡) Aâ‰¡ (Ï€â‚rwâ‰¡ Î“â‰¡ tâ‰¡)) 
           ]â‰¡á´¾ âŸ¦uâ‚‚âŸ§
    â†’ âŸ¦vâ‚âŸ§ â‰¡[ Tmâ‰¡ (,>rwâ‰¡ Î“â‰¡ tâ‰¡) ([]Tâ‰¡ Î“â‰¡ (,>rwâ‰¡ Î“â‰¡ tâ‰¡) Aâ‰¡ (Ï€â‚rwâ‰¡ Î“â‰¡ tâ‰¡)) 
           ]â‰¡á´¾ âŸ¦vâ‚‚âŸ§
    â†’ âŸ¦ifâŸ§ âŸ¦tâ‚âŸ§ âŸ¦uâ‚âŸ§ âŸ¦vâ‚âŸ§ â‰¡[ Tmâ‰¡ Î“â‰¡ Aâ‰¡ ]â‰¡á´¾ âŸ¦ifâŸ§ âŸ¦tâ‚‚âŸ§ âŸ¦uâ‚‚âŸ§ âŸ¦vâ‚‚âŸ§
ifâ‰¡ refl refl refl refl refl = refl

âŸ¦_âŸ§Sortâ„“ : Sort â†’ Level

âŸ¦ ctx     âŸ§Sortâ„“ = 1â„“
âŸ¦ ty _    âŸ§Sortâ„“ = 1â„“
âŸ¦ tm _ _  âŸ§Sortâ„“ = 0â„“
âŸ¦ tms _ _ âŸ§Sortâ„“ = 0â„“

âŸ¦_âŸ§Sort : âˆ€ ğ’® â†’ Set âŸ¦ ğ’® âŸ§Sortâ„“

{-# TERMINATING #-}
âŸ¦_âŸ§_ : Syn ğ’® â†’ SortMarker ğ’® â†’ âŸ¦ ğ’® âŸ§Sort
âŸ¦_âŸ§Ctx : Ctx â†’ âŸ¦CtxâŸ§
âŸ¦_âŸ§Ty  : Ty Î“ â†’ âŸ¦TyâŸ§ âŸ¦ Î“ âŸ§Ctx
âŸ¦_âŸ§Tm  : Tm Î“ A â†’ âŸ¦TmâŸ§ âŸ¦ Î“ âŸ§Ctx âŸ¦ A âŸ§Ty
âŸ¦_âŸ§Tms : Tms Î” Î“ â†’ âŸ¦TmsâŸ§ âŸ¦ Î” âŸ§Ctx âŸ¦ Î“ âŸ§Ctx

âŸ¦ ctx     âŸ§Sort = Set
âŸ¦ ty Î“    âŸ§Sort = âŸ¦TyâŸ§ âŸ¦ Î“ âŸ§Ctx
âŸ¦ tm Î“ A  âŸ§Sort = âŸ¦TmâŸ§ âŸ¦ Î“ âŸ§Ctx âŸ¦ A âŸ§Ty
âŸ¦ tms Î” Î“ âŸ§Sort = âŸ¦TmsâŸ§ âŸ¦ Î” âŸ§Ctx âŸ¦ Î“ âŸ§Ctx

âŸ¦_âŸ§Ctx = âŸ¦_âŸ§ CTX
âŸ¦_âŸ§Ty  = âŸ¦_âŸ§ TY
âŸ¦_âŸ§Tm  = âŸ¦_âŸ§ TM
âŸ¦_âŸ§Tms = âŸ¦_âŸ§ TMS

variable
  Ï Ïâ‚ Ïâ‚‚ : âŸ¦Î“âŸ§

âŸ¦_âŸ§Ctx~ : Ctx~ Î“â‚ Î“â‚‚ â†’ âŸ¦ Î“â‚ âŸ§Ctx â‰¡á´¾ âŸ¦ Î“â‚‚ âŸ§Ctx
âŸ¦_âŸ§Ty~  : Ty~ Î“~ Aâ‚ Aâ‚‚ â†’ âŸ¦ Aâ‚ âŸ§Ty â‰¡[ congá´¾ âŸ¦TyâŸ§ âŸ¦ Î“~ âŸ§Ctx~ ]â‰¡á´¾ âŸ¦ Aâ‚‚ âŸ§Ty
âŸ¦_âŸ§Tm~  : Tm~ Î“~ A~ tâ‚ tâ‚‚ 
         â†’ âŸ¦ tâ‚ âŸ§Tm â‰¡[ Tmâ‰¡ âŸ¦ Î“~ âŸ§Ctx~ âŸ¦ A~ âŸ§Ty~ ]â‰¡á´¾ âŸ¦ tâ‚‚ âŸ§Tm
âŸ¦_âŸ§Tms~ : Tms~ Î”~ Î“~ Î´â‚ Î´â‚‚ 
         â†’ âŸ¦ Î´â‚ âŸ§Tms â‰¡[ Tmsâ‰¡ âŸ¦ Î”~ âŸ§Ctx~ âŸ¦ Î“~ âŸ§Ctx~ ]â‰¡á´¾ âŸ¦ Î´â‚‚ âŸ§Tms

âŸ¦ğ”¹âŸ§â€² : âŸ¦ ğ”¹ {Î“ = Î“} âŸ§Ty â‰¡á´¾ Î» Ï â†’ Bool 

Tyâ‰¡-inst : âŸ¦Aâ‚âŸ§ â‰¡á´¾ âŸ¦Aâ‚‚âŸ§ â†’ âŸ¦Aâ‚âŸ§ Ï â‰¡á´¾ âŸ¦Aâ‚‚âŸ§ Ï
Tyâ‰¡-inst refl = refl

Tmâ‰¡-inst : âŸ¦tâ‚âŸ§ â‰¡á´¾ âŸ¦tâ‚‚âŸ§ â†’ âŸ¦tâ‚âŸ§ Ï â‰¡á´¾ âŸ¦tâ‚‚âŸ§ Ï
Tmâ‰¡-inst refl = refl

Tm[]â‰¡-inst : âˆ€ {Ï : âŸ¦ Î“ âŸ§Ctx} (Aâ‰¡ : âŸ¦Aâ‚âŸ§ â‰¡á´¾ âŸ¦Aâ‚‚âŸ§) â†’ âŸ¦tâ‚âŸ§ â‰¡[ Tmâ‰¡ refl Aâ‰¡ ]â‰¡á´¾ âŸ¦tâ‚‚âŸ§ 
           â†’ âŸ¦tâ‚âŸ§ Ï â‰¡[ Tyâ‰¡-inst Aâ‰¡ ]â‰¡á´¾ âŸ¦tâ‚‚âŸ§ Ï
Tm[]â‰¡-inst refl refl = refl

âŸ¦ Îµ     âŸ§ CTX = âŠ¤
âŸ¦ Î“ , A âŸ§ CTX = Î£ âŸ¦ Î“ âŸ§Ctx âŸ¦ A âŸ§Ty

âŸ¦ ğ”¹ âŸ§ TY = Î» Ï â†’ Bool

âŸ¦ Î“ , t >rw b âŸ§ CTX = Î£ âŸ¦ Î“ âŸ§Ctx (Î» Ï â†’ Box (âŸ¦ t âŸ§Tm Ï â‰¡á´¾ b))

âŸ¦ coe~ Î“~ A âŸ§ TY = coeá´¾ (Tyâ‰¡ âŸ¦ Î“~ âŸ§Ctx~) âŸ¦ A âŸ§Ty
âŸ¦ Î  A B     âŸ§ TY = Î» Ï â†’ âˆ€ x â†’ âŸ¦ B âŸ§Ty (Ï Î£, x)
âŸ¦ A [ Î´ ]   âŸ§ TY = Î» Ï â†’ âŸ¦ A âŸ§Ty (âŸ¦ Î´ âŸ§Tms Ï)
âŸ¦ if t A B  âŸ§ TY = Î» Ï â†’ Bool-rec (âŸ¦ t âŸ§Tm Ï) (âŸ¦ A âŸ§Ty Ï) (âŸ¦ B âŸ§Ty Ï)

âŸ¦ coe~ Î“~ A~ t âŸ§ TM = coeá´¾ (Tmâ‰¡ âŸ¦ Î“~ âŸ§Ctx~ âŸ¦ A~ âŸ§Ty~) âŸ¦ t âŸ§Tm

âŸ¦ Æ› t     âŸ§ TM = Î» Ï        x â†’ âŸ¦ t âŸ§Tm (Ï Î£, x)
âŸ¦ Æ›â»Â¹ t   âŸ§ TM = Î» (Ï Î£, x)   â†’ âŸ¦ t âŸ§Tm Ï x
âŸ¦ TT      âŸ§ TM = Î» Ï          â†’ true
âŸ¦ FF      âŸ§ TM = Î» Ï          â†’ false
âŸ¦ t [ Î´ ] âŸ§ TM = Î» Ï          â†’ âŸ¦ t âŸ§Tm (âŸ¦ Î´ âŸ§Tms Ï)

âŸ¦ Ï€â‚ Î´  âŸ§ TMS = Î» Ï â†’ âŸ¦ Î´ âŸ§Tms Ï .fst

âŸ¦ Ï€â‚‚ Î´  âŸ§ TM = Î» Ï â†’ âŸ¦ Î´ âŸ§Tms Ï .snd

âŸ¦ id     âŸ§ TMS = Î» Ï â†’ Ï
âŸ¦ Ï€â‚rw Î´ âŸ§ TMS = Î» Ï â†’ âŸ¦ Î´ âŸ§Tms Ï .fst

âŸ¦ if t u v âŸ§ TM = Î» Ï â†’ Bool-splitá´¾ (âŸ¦ t âŸ§Tm Ï) (Î» t~ â†’ âŸ¦ u âŸ§Tm (Ï Î£, box t~)) 
                                                (Î» t~ â†’ âŸ¦ v âŸ§Tm (Ï Î£, box t~))
                                          
âŸ¦ coe~ Î”~ Î“~ Î´ âŸ§ TMS = coeá´¾ (Tmsâ‰¡ âŸ¦ Î”~ âŸ§Ctx~ âŸ¦ Î“~ âŸ§Ctx~) âŸ¦ Î´ âŸ§Tms
âŸ¦ Îµ            âŸ§ TMS = Î» Ï â†’ tt
âŸ¦ Î´ , t        âŸ§ TMS = Î» Ï â†’ âŸ¦ Î´ âŸ§Tms Ï Î£, âŸ¦ t âŸ§Tm Ï

âŸ¦ ,rwâ„± {b = true} Î´ refl t~ âŸ§ TMS 
  = Î» Ï â†’ âŸ¦ Î´ âŸ§Tms Ï Î£, box (Tmâ‰¡-inst âŸ¦ t~ âŸ§Tm~)
âŸ¦ ,rwâ„± {b = false} Î´ refl t~ âŸ§ TMS 
  = Î» Ï â†’ âŸ¦ Î´ âŸ§Tms Ï Î£, box (Tmâ‰¡-inst âŸ¦ t~ âŸ§Tm~)
âŸ¦ Î´ â¨¾ Ïƒ âŸ§ TMS = Î» Ï â†’ âŸ¦ Î´ âŸ§Tms (âŸ¦ Ïƒ âŸ§Tms Ï)
  
âŸ¦ğ”¹âŸ§â€² = refl

âŸ¦ rfl~         âŸ§Ctx~ = refl
âŸ¦ sym~ Î“~      âŸ§Ctx~ = symá´¾ âŸ¦ Î“~ âŸ§Ctx~
âŸ¦ Î“â‚â‚‚~ âˆ™~ Î“â‚‚â‚ƒ~ âŸ§Ctx~ = âŸ¦ Î“â‚â‚‚~ âŸ§Ctx~ âˆ™á´¾ âŸ¦ Î“â‚‚â‚ƒ~ âŸ§Ctx~
âŸ¦ Î“~ , A~      âŸ§Ctx~ = ,â‰¡ âŸ¦ Î“~ âŸ§Ctx~ âŸ¦ A~ âŸ§Ty~
âŸ¦ Î“~ , t~ >rw  âŸ§Ctx~ = ,>rwâ‰¡ âŸ¦ Î“~ âŸ§Ctx~ âŸ¦ t~ âŸ§Tm~

âŸ¦ rfl~              âŸ§Ty~ = refl
âŸ¦ sym~ A~           âŸ§Ty~ = sym[]á´¾ âŸ¦ A~ âŸ§Ty~
âŸ¦ Aâ‚â‚‚~ âˆ™~ Aâ‚‚â‚ƒ~      âŸ§Ty~ = âŸ¦ Aâ‚â‚‚~ âŸ§Ty~ âˆ™[]á´¾ âŸ¦ Aâ‚‚â‚ƒ~ âŸ§Ty~
âŸ¦ coh               âŸ§Ty~ = coh[]á´¾
âŸ¦ ğ”¹ {Î“~ = Î“~}       âŸ§Ty~ = ğ”¹â‰¡ âŸ¦ Î“~ âŸ§Ctx~
âŸ¦ Î  {Î“~ = Î“~} A~ B~ âŸ§Ty~ = Î â‰¡ âŸ¦ Î“~ âŸ§Ctx~ âŸ¦ A~ âŸ§Ty~ âŸ¦ B~ âŸ§Ty~

âŸ¦ _[_] {Î“~ = Î“~} {Î”~ = Î”~} A~ Î´~ âŸ§Ty~ 
  = []Tâ‰¡ âŸ¦ Î“~ âŸ§Ctx~ âŸ¦ Î”~ âŸ§Ctx~ âŸ¦ A~ âŸ§Ty~ (âŸ¦ Î´~ âŸ§Tms~)

âŸ¦ ğ”¹[]  âŸ§Ty~ = refl
âŸ¦ [][] âŸ§Ty~ = refl
âŸ¦ [id] âŸ§Ty~ = refl

âŸ¦ rfl~               âŸ§Tm~ = refl
âŸ¦ sym~ t~            âŸ§Tm~ = sym[]á´¾ âŸ¦ t~ âŸ§Tm~
âŸ¦ tâ‚â‚‚~ âˆ™~ tâ‚‚â‚ƒ~       âŸ§Tm~ = âŸ¦ tâ‚â‚‚~ âŸ§Tm~ âˆ™[]á´¾ âŸ¦ tâ‚‚â‚ƒ~ âŸ§Tm~
âŸ¦ coh                âŸ§Tm~ = coh[]á´¾
âŸ¦ TT Î“~              âŸ§Tm~ = TTâ‰¡ âŸ¦ Î“~ âŸ§Ctx~
âŸ¦ FF Î“~              âŸ§Tm~ = FFâ‰¡ âŸ¦ Î“~ âŸ§Ctx~

âŸ¦ if {Î“~ = Î“~} {A~ = A~} t~ u~ v~ âŸ§Tm~ 
  = ifâ‰¡ âŸ¦ Î“~ âŸ§Ctx~ âŸ¦ A~ âŸ§Ty~ âŸ¦ t~ âŸ§Tm~ âŸ¦ u~ âŸ§Tm~ âŸ¦ v~ âŸ§Tm~

âŸ¦ t~ [ Î´~ ]          âŸ§Tm~ = {!   !}
âŸ¦ Ï€â‚‚rw {b = true}  Î´ âŸ§Tm~ = funextá´¾ (Î» Ï â†’ âŸ¦ Î´ âŸ§Tms Ï .snd .unbox)
âŸ¦ Ï€â‚‚rw {b = false} Î´ âŸ§Tm~ = funextá´¾ (Î» Ï â†’ âŸ¦ Î´ âŸ§Tms Ï .snd .unbox)
âŸ¦ TT[]               âŸ§Tm~ = refl
âŸ¦ FF[]               âŸ§Tm~ = refl
âŸ¦ [id]               âŸ§Tm~ = refl
âŸ¦ [][]               âŸ§Tm~ = refl
âŸ¦ ifTT               âŸ§Tm~ = refl
âŸ¦ ifFF               âŸ§Tm~ = refl
âŸ¦ Ï€â‚‚â¨¾                âŸ§Tm~ = refl

âŸ¦ rfl~              âŸ§Tms~ = refl
âŸ¦ sym~ Î´~           âŸ§Tms~ = sym[]á´¾ âŸ¦ Î´~ âŸ§Tms~
âŸ¦ Î´â‚â‚‚~ âˆ™~ Î´â‚‚â‚ƒ~      âŸ§Tms~ = âŸ¦ Î´â‚â‚‚~ âŸ§Tms~ âˆ™[]á´¾ âŸ¦ Î´â‚‚â‚ƒ~ âŸ§Tms~
âŸ¦ coh               âŸ§Tms~ = coh[]á´¾
âŸ¦ Î´~ , t~           âŸ§Tms~ = {!   !}
âŸ¦ ,rw~ Î´~           âŸ§Tms~ = {!   !}
âŸ¦ id                âŸ§Tms~ = {!   !}
âŸ¦ Î´~ â¨¾ Ïƒ~           âŸ§Tms~ = {!   !}
âŸ¦ Ï€â‚rw t~ Î´~        âŸ§Tms~ = {!   !}
âŸ¦ ÎµÎ·                âŸ§Tms~ = refl
âŸ¦ ,Î·                âŸ§Tms~ = refl
âŸ¦ Ï€rwÎ· {b = true}   âŸ§Tms~ = refl
âŸ¦ Ï€rwÎ· {b = false}  âŸ§Tms~ = refl
âŸ¦ Ï€â‚rw, {b = false} âŸ§Tms~ = refl
âŸ¦ Ï€â‚rw, {b = true}  âŸ§Tms~ = refl
âŸ¦ Ï€â‚â¨¾               âŸ§Tms~ = refl
âŸ¦ Ï€â‚rwâ¨¾             âŸ§Tms~ = refl
âŸ¦ idâ¨¾               âŸ§Tms~ = refl
âŸ¦ â¨¾id               âŸ§Tms~ = refl
âŸ¦ ,â¨¾                âŸ§Tms~ = refl
âŸ¦ ,rwâ¨¾ {b = true}   âŸ§Tms~ = refl
âŸ¦ ,rwâ¨¾ {b = false}  âŸ§Tms~ = refl
