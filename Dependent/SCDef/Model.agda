{-# OPTIONS --prop --rewriting --show-irrelevant 
            --no-require-unique-meta-solutions #-}

open import Utils
open import Utils.IdExtras

open import Dependent.SCDef.Syntax

-- Like "ModelOld.agda" but without asserting termination.
--
-- To achieve this, we use some trickery with foeqard references, with-clauses 
-- and specialising helpers, which makes unfortunately the definitions a bit 
-- clunkier in places.
module Dependent.SCDef.Model where

‚ü¶Sig‚üß : Set‚ÇÅ
‚ü¶Sig‚üß = Set


‚ü¶Ctx‚üß : ‚ü¶Sig‚üß ‚Üí Set‚ÇÅ
‚ü¶Ctx‚üß ‚ü¶Œ®‚üß = ‚ü¶Œ®‚üß ‚Üí Set

variable
  ‚ü¶Œ®‚üß ‚ü¶Œ¶‚üß ‚ü¶Œû‚üß : ‚ü¶Sig‚üß 

‚ü¶Ty‚üß : ‚ü¶Ctx‚üß ‚ü¶Œ®‚üß ‚Üí Set‚ÇÅ
‚ü¶Ty‚üß ‚ü¶Œì‚üß = ‚àÄ œá ‚Üí ‚ü¶Œì‚üß œá ‚Üí Set

‚ü¶Tm‚üß : ‚àÄ (‚ü¶Œì‚üß : ‚ü¶Ctx‚üß ‚ü¶Œ®‚üß) ‚Üí ‚ü¶Ty‚üß ‚ü¶Œì‚üß ‚Üí Set
‚ü¶Tm‚üß ‚ü¶Œì‚üß ‚ü¶A‚üß = ‚àÄ œá œÅ ‚Üí ‚ü¶A‚üß œá œÅ

‚ü¶Wk‚üß : ‚ü¶Sig‚üß ‚Üí ‚ü¶Sig‚üß ‚Üí Set
‚ü¶Wk‚üß ‚ü¶Œ¶‚üß ‚ü¶Œ®‚üß = ‚ü¶Œ¶‚üß ‚Üí ‚ü¶Œ®‚üß

‚ü¶[]C‚üß : ‚ü¶Ctx‚üß ‚ü¶Œ®‚üß ‚Üí ‚ü¶Wk‚üß ‚ü¶Œ¶‚üß ‚ü¶Œ®‚üß ‚Üí ‚ü¶Ctx‚üß ‚ü¶Œ¶‚üß
‚ü¶[]C‚üß ‚ü¶Œì‚üß ‚ü¶Œ¥‚üß = Œª œá ‚Üí ‚ü¶Œì‚üß (‚ü¶Œ¥‚üß œá)

‚ü¶Tms‚üß : ‚ü¶Ctx‚üß ‚ü¶Œ¶‚üß ‚Üí ‚ü¶Ctx‚üß ‚ü¶Œ®‚üß ‚Üí Set
‚ü¶Tms‚üß {‚ü¶Œ¶‚üß = ‚ü¶Œ¶‚üß} {‚ü¶Œ®‚üß = ‚ü¶Œ®‚üß} ‚ü¶Œî‚üß ‚ü¶Œì‚üß 
  = Œ£ (‚ü¶Wk‚üß ‚ü¶Œ¶‚üß ‚ü¶Œ®‚üß) Œª ‚ü¶Œ¥‚üß ‚Üí ‚àÄ {œá} ‚Üí ‚ü¶Œî‚üß œá ‚Üí ‚ü¶[]C‚üß ‚ü¶Œì‚üß ‚ü¶Œ¥‚üß œá

variable
  ‚ü¶Œ®‚ÇÅ‚üß ‚ü¶Œ®‚ÇÇ‚üß ‚ü¶Œ¶‚ÇÅ‚üß ‚ü¶Œ¶‚ÇÇ‚üß : ‚ü¶Sig‚üß
  ‚ü¶Œì‚üß ‚ü¶Œî‚üß ‚ü¶Œò‚üß ‚ü¶Œì‚ÇÅ‚üß ‚ü¶Œì‚ÇÇ‚üß ‚ü¶Œî‚ÇÅ‚üß ‚ü¶Œî‚ÇÇ‚üß ‚ü¶Œò‚ÇÅ‚üß ‚ü¶Œò‚ÇÇ‚üß       : ‚ü¶Ctx‚üß ‚ü¶Œ®‚üß
  ‚ü¶A‚üß ‚ü¶B‚üß ‚ü¶A‚ÇÅ‚üß ‚ü¶A‚ÇÇ‚üß ‚ü¶B‚ÇÅ‚üß ‚ü¶B‚ÇÇ‚üß       : ‚ü¶Ty‚üß  ‚ü¶Œì‚üß 
  ‚ü¶t‚üß ‚ü¶u‚üß ‚ü¶v‚üß ‚ü¶t‚ÇÅ‚üß ‚ü¶t‚ÇÇ‚üß ‚ü¶u‚ÇÅ‚üß ‚ü¶u‚ÇÇ‚üß ‚ü¶v‚ÇÅ‚üß ‚ü¶v‚ÇÇ‚üß : ‚ü¶Tm‚üß  ‚ü¶Œì‚üß ‚ü¶A‚üß
  ‚ü¶Œ¥‚üß ‚ü¶Œ¥‚ÇÅ‚üß ‚ü¶Œ¥‚ÇÇ‚üß ‚ü¶œÉ‚ÇÅ‚üß ‚ü¶œÉ‚ÇÇ‚üß                     : ‚ü¶Tms‚üß ‚ü¶Œî‚üß ‚ü¶Œì‚üß
  ‚ü¶Œ≥‚üß ‚ü¶Œ≥‚ÇÅ‚üß ‚ü¶Œ≥‚ÇÇ‚üß                 : ‚ü¶Wk‚üß ‚ü¶Œ¶‚üß ‚ü¶Œ®‚üß

Ctx‚â° : ‚ü¶Œ®‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œ®‚ÇÇ‚üß ‚Üí ‚ü¶Ctx‚üß ‚ü¶Œ®‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Ctx‚üß ‚ü¶Œ®‚ÇÇ‚üß
Ctx‚â° refl = refl

Ty‚â° : ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œì‚ÇÇ‚üß ‚Üí ‚ü¶Ty‚üß {‚ü¶Œ®‚üß = ‚ü¶Œ®‚üß} ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Ty‚üß ‚ü¶Œì‚ÇÇ‚üß
Ty‚â° refl = refl

Tm‚â° : ‚àÄ Œì‚â° ‚Üí ‚àÄ (A‚â° : ‚ü¶A‚ÇÅ‚üß ‚â°[ Ty‚â° {‚ü¶Œ®‚üß = ‚ü¶Œ®‚üß} Œì‚â° ]‚â°·¥æ ‚ü¶A‚ÇÇ‚üß) 
    ‚Üí ‚ü¶Tm‚üß ‚ü¶Œì‚ÇÅ‚üß ‚ü¶A‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Tm‚üß ‚ü¶Œì‚ÇÇ‚üß ‚ü¶A‚ÇÇ‚üß
Tm‚â° refl refl = refl

Wk‚â° : ‚ü¶Œ¶‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œ¶‚ÇÇ‚üß ‚Üí ‚ü¶Œ®‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œ®‚ÇÇ‚üß ‚Üí ‚ü¶Wk‚üß ‚ü¶Œ¶‚ÇÅ‚üß ‚ü¶Œ®‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Wk‚üß ‚ü¶Œ¶‚ÇÇ‚üß ‚ü¶Œ®‚ÇÇ‚üß
Wk‚â° refl refl = refl

Tms‚â° : ‚ü¶Œî‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œî‚ÇÇ‚üß ‚Üí ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œì‚ÇÇ‚üß ‚Üí ‚ü¶Tms‚üß ‚ü¶Œî‚ÇÅ‚üß ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Tms‚üß ‚ü¶Œî‚ÇÇ‚üß ‚ü¶Œì‚ÇÇ‚üß
Tms‚â° refl refl = refl

Tms‚â°‚Ä≤ : ‚àÄ (Œ¶‚â° : ‚ü¶Œ¶‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œ¶‚ÇÇ‚üß) (Œ®‚â° : ‚ü¶Œ®‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œ®‚ÇÇ‚üß) 
          (Œî‚â° : ‚ü¶Œî‚ÇÅ‚üß ‚â°[ Ctx‚â° Œ¶‚â° ]‚â°·¥æ ‚ü¶Œî‚ÇÇ‚üß) 
          (Œì‚â° : ‚ü¶Œì‚ÇÅ‚üß ‚â°[ Ctx‚â° Œ®‚â° ]‚â°·¥æ ‚ü¶Œì‚ÇÇ‚üß)
      ‚Üí ‚ü¶Tms‚üß ‚ü¶Œî‚ÇÅ‚üß ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Tms‚üß ‚ü¶Œî‚ÇÇ‚üß ‚ü¶Œì‚ÇÇ‚üß 
Tms‚â°‚Ä≤ refl refl refl refl = refl

‚ü¶ùîπ‚üß : ‚ü¶Ty‚üß ‚ü¶Œì‚üß
‚ü¶ùîπ‚üß = Œª œá œÅ ‚Üí Bool

‚ü¶‚ñ∑>eq‚üß : ‚àÄ (‚ü¶Œì‚üß : ‚ü¶Ctx‚üß ‚ü¶Œ®‚üß) ‚Üí ‚ü¶Tm‚üß ‚ü¶Œì‚üß ‚ü¶ùîπ‚üß ‚Üí Bool ‚Üí ‚ü¶Ctx‚üß ‚ü¶Œ®‚üß
‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚üß ‚ü¶t‚üß b = Œª œá ‚Üí Œ£ (‚ü¶Œì‚üß œá) (Œª œÅ ‚Üí Box (‚ü¶t‚üß œá œÅ ‚â°·¥æ b))

‚ü¶idùíÆ‚üß : ‚ü¶Wk‚üß ‚ü¶Œ®‚üß ‚ü¶Œ®‚üß
‚ü¶idùíÆ‚üß = Œª œá ‚Üí œá

‚ü¶id‚üß : ‚ü¶Tms‚üß ‚ü¶Œì‚üß ‚ü¶Œì‚üß
‚ü¶id‚üß = ‚ü¶idùíÆ‚üß Œ£, Œª œÅ ‚Üí œÅ

‚ü¶wkeq‚üß : ‚ü¶Tms‚üß (‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚üß ‚ü¶t‚üß b) ‚ü¶Œì‚üß
‚ü¶wkeq‚üß = ‚ü¶idùíÆ‚üß Œ£, fst

‚ü¶œÄ‚ÇÅeq‚üß : ‚ü¶Tms‚üß ‚ü¶Œî‚üß (‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚üß ‚ü¶t‚üß b) ‚Üí ‚ü¶Tms‚üß ‚ü¶Œî‚üß ‚ü¶Œì‚üß
‚ü¶œÄ‚ÇÅeq‚üß ‚ü¶Œ¥‚üß = ‚ü¶Œ¥‚üß .fst Œ£, Œª œÅ ‚Üí ‚ü¶Œ¥‚üß .snd œÅ .fst


‚ü¶[]T‚üß : ‚ü¶Ty‚üß ‚ü¶Œì‚üß ‚Üí ‚ü¶Tms‚üß ‚ü¶Œî‚üß ‚ü¶Œì‚üß ‚Üí ‚ü¶Ty‚üß ‚ü¶Œî‚üß
‚ü¶[]T‚üß ‚ü¶A‚üß ‚ü¶Œ¥‚üß œá œÅ = ‚ü¶A‚üß (‚ü¶Œ¥‚üß .fst œá) (‚ü¶Œ¥‚üß .snd œÅ)

‚ü¶‚ñ∑ùíÆ‚üß : ‚àÄ ‚ü¶Œ®‚üß (‚ü¶Œì‚üß : ‚ü¶Ctx‚üß ‚ü¶Œ®‚üß) ‚ü¶A‚üß ‚ü¶t‚üß
     ‚Üí ‚ü¶Tm‚üß (‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚üß ‚ü¶t‚üß true)   (‚ü¶[]T‚üß ‚ü¶A‚üß ‚ü¶wkeq‚üß) 
     ‚Üí ‚ü¶Tm‚üß (‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚üß ‚ü¶t‚üß false)  (‚ü¶[]T‚üß ‚ü¶A‚üß ‚ü¶wkeq‚üß) 
     ‚Üí ‚ü¶Sig‚üß
‚ü¶‚ñ∑ùíÆ‚üß ‚ü¶Œ®‚üß ‚ü¶Œì‚üß ‚ü¶A‚üß ‚ü¶t‚üß ‚ü¶u‚üß ‚ü¶v‚üß 
  = Œ£ ‚ü¶Œ®‚üß Œª œá ‚Üí 
    Œ£ (‚àÄ œÅ ‚Üí ‚ü¶A‚üß œá œÅ) Œª f ‚Üí 
      (‚àÄ œÅ (t~ : ‚ü¶t‚üß œá œÅ ‚â°·¥æ true) 
    ‚Üí Box (f œÅ ‚â°·¥æ ‚ü¶u‚üß œá (œÅ Œ£, box t~)))
    √ó (‚àÄ œÅ (t~ : ‚ü¶t‚üß œá œÅ ‚â°·¥æ false)
    ‚Üí Box (f œÅ ‚â°·¥æ ‚ü¶v‚üß œá (œÅ Œ£, box t~)))

‚ü¶‚®æùíÆ‚üß : ‚ü¶Wk‚üß ‚ü¶Œ¶‚üß ‚ü¶Œ®‚üß ‚Üí ‚ü¶Wk‚üß ‚ü¶Œû‚üß ‚ü¶Œ¶‚üß ‚Üí ‚ü¶Wk‚üß ‚ü¶Œû‚üß ‚ü¶Œ®‚üß
‚ü¶‚®æùíÆ‚üß ‚ü¶Œ¥‚üß ‚ü¶œÉ‚üß = Œª œá ‚Üí ‚ü¶Œ¥‚üß (‚ü¶œÉ‚üß œá)

‚ü¶‚åú‚åùùíÆ‚üß : ‚àÄ (‚ü¶Œ¥‚üß : ‚ü¶Wk‚üß ‚ü¶Œ¶‚üß ‚ü¶Œ®‚üß) ‚Üí ‚ü¶Tms‚üß (‚ü¶[]C‚üß ‚ü¶Œì‚üß ‚ü¶Œ¥‚üß) ‚ü¶Œì‚üß
‚ü¶‚åú‚åùùíÆ‚üß ‚ü¶Œ¥‚üß = ‚ü¶Œ¥‚üß Œ£, Œª œÅ ‚Üí œÅ

‚ü¶‚®æ‚üß : ‚ü¶Tms‚üß ‚ü¶Œî‚üß ‚ü¶Œì‚üß ‚Üí ‚ü¶Tms‚üß ‚ü¶Œò‚üß ‚ü¶Œî‚üß ‚Üí ‚ü¶Tms‚üß ‚ü¶Œò‚üß ‚ü¶Œì‚üß
‚ü¶‚®æ‚üß (‚ü¶Œ¥‚üß Œ£, ‚ü¶Œ¥‚üß‚Ä≤) (‚ü¶œÉ‚üß Œ£, ‚ü¶œÉ‚üß‚Ä≤) = ‚ü¶‚®æùíÆ‚üß ‚ü¶Œ¥‚üß ‚ü¶œÉ‚üß Œ£, Œª œÅ ‚Üí ‚ü¶Œ¥‚üß‚Ä≤ (‚ü¶œÉ‚üß‚Ä≤ œÅ)

‚ü¶Œµ‚üß : ‚ü¶Ctx‚üß ‚ü¶Œ®‚üß
‚ü¶Œµ‚üß = Œª _ ‚Üí ‚ä§

‚ü¶wkùíÆ‚üß : ‚ü¶‚ñ∑ùíÆ‚üß ‚ü¶Œ®‚üß ‚ü¶Œì‚üß ‚ü¶A‚üß ‚ü¶t‚üß ‚ü¶u‚üß ‚ü¶v‚üß ‚Üí ‚ü¶Œ®‚üß
‚ü¶wkùíÆ‚üß (œá Œ£, f) = œá

‚ü¶call‚üß : ‚ü¶Tm‚üß {‚ü¶Œ®‚üß = ‚ü¶‚ñ∑ùíÆ‚üß ‚ü¶Œ®‚üß ‚ü¶Œì‚üß ‚ü¶A‚üß ‚ü¶t‚üß ‚ü¶u‚üß ‚ü¶v‚üß} 
              (‚ü¶[]C‚üß ‚ü¶Œì‚üß ‚ü¶wkùíÆ‚üß) (‚ü¶[]T‚üß ‚ü¶A‚üß (‚ü¶‚åú‚åùùíÆ‚üß ‚ü¶wkùíÆ‚üß))
‚ü¶call‚üß (œá Œ£, f) œÅ = f .fst œÅ

variable
  Œ¶‚â° Œ®‚â° : ‚ü¶Œ®‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œ®‚ÇÇ‚üß
  Œì‚â° Œî‚â° : ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œì‚ÇÇ‚üß
  A‚â° : ‚ü¶A‚ÇÅ‚üß ‚â°[ Ty‚â° Œì‚â° ]‚â°·¥æ ‚ü¶A‚ÇÇ‚üß

‚ü¶‚ñ∑‚üß : ‚àÄ (‚ü¶Œì‚üß : ‚ü¶Ctx‚üß ‚ü¶Œ®‚üß) ‚Üí ‚ü¶Ty‚üß ‚ü¶Œì‚üß ‚Üí ‚ü¶Ctx‚üß ‚ü¶Œ®‚üß
‚ü¶‚ñ∑‚üß ‚ü¶Œì‚üß ‚ü¶A‚üß = Œª œá ‚Üí Œ£ (‚ü¶Œì‚üß œá) (Œª œÅ ‚Üí ‚ü¶A‚üß œá œÅ) 

‚ñ∑‚â° : ‚àÄ Œì‚â° ‚Üí ‚ü¶A‚ÇÅ‚üß ‚â°[ Ty‚â° Œì‚â° ]‚â°·¥æ ‚ü¶A‚ÇÇ‚üß ‚Üí ‚ü¶‚ñ∑‚üß ‚ü¶Œì‚ÇÅ‚üß ‚ü¶A‚ÇÅ‚üß ‚â°·¥æ ‚ü¶‚ñ∑‚üß ‚ü¶Œì‚ÇÇ‚üß ‚ü¶A‚ÇÇ‚üß 
‚ñ∑‚â° refl refl = refl

‚ü¶Œ†‚üß : ‚àÄ ‚ü¶A‚üß ‚Üí ‚ü¶Ty‚üß (‚ü¶‚ñ∑‚üß ‚ü¶Œì‚üß ‚ü¶A‚üß) ‚Üí ‚ü¶Ty‚üß ‚ü¶Œì‚üß
‚ü¶Œ†‚üß ‚ü¶A‚üß ‚ü¶B‚üß = Œª œá œÅ ‚Üí ‚àÄ u‚±Ω ‚Üí ‚ü¶B‚üß œá (œÅ Œ£, u‚±Ω)

ùîπ‚â° : ‚àÄ (Œì‚â° : ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œì‚ÇÇ‚üß) ‚Üí ‚ü¶ùîπ‚üß ‚â°[ Ty‚â° Œì‚â° ]‚â°·¥æ ‚ü¶ùîπ‚üß
ùîπ‚â° refl = refl

‚ñ∑>eq‚â° : ‚àÄ (Œì‚â° : ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œì‚ÇÇ‚üß) ‚Üí ‚ü¶t‚ÇÅ‚üß ‚â°[ Tm‚â° Œì‚â° (ùîπ‚â° Œì‚â°) ]‚â°·¥æ ‚ü¶t‚ÇÇ‚üß 
      ‚Üí ‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚ÇÅ‚üß ‚ü¶t‚ÇÅ‚üß b ‚â°·¥æ ‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚ÇÇ‚üß ‚ü¶t‚ÇÇ‚üß b
‚ñ∑>eq‚â° refl refl = refl

‚®æ‚â° : ‚àÄ {‚ü¶Œ¥‚ÇÅ‚üß : ‚ü¶Tms‚üß ‚ü¶Œî‚ÇÅ‚üß ‚ü¶Œì‚ÇÅ‚üß} {‚ü¶Œ¥‚ÇÇ‚üß : ‚ü¶Tms‚üß ‚ü¶Œî‚ÇÇ‚üß ‚ü¶Œì‚ÇÇ‚üß} 
       {‚ü¶œÉ‚ÇÅ‚üß : ‚ü¶Tms‚üß ‚ü¶Œò‚ÇÅ‚üß ‚ü¶Œî‚ÇÅ‚üß} {‚ü¶œÉ‚ÇÇ‚üß : ‚ü¶Tms‚üß ‚ü¶Œò‚ÇÇ‚üß ‚ü¶Œî‚ÇÇ‚üß}
       (Œì‚â° : ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œì‚ÇÇ‚üß) (Œî‚â° : ‚ü¶Œî‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œî‚ÇÇ‚üß) (Œò‚â° : ‚ü¶Œò‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œò‚ÇÇ‚üß)
   ‚Üí ‚ü¶Œ¥‚ÇÅ‚üß ‚â°[ Tms‚â° Œî‚â° Œì‚â° ]‚â°·¥æ ‚ü¶Œ¥‚ÇÇ‚üß 
   ‚Üí ‚ü¶œÉ‚ÇÅ‚üß ‚â°[ Tms‚â° Œò‚â° Œî‚â° ]‚â°·¥æ ‚ü¶œÉ‚ÇÇ‚üß
   ‚Üí ‚ü¶‚®æ‚üß {‚ü¶Œì‚üß = ‚ü¶Œì‚ÇÅ‚üß} ‚ü¶Œ¥‚ÇÅ‚üß ‚ü¶œÉ‚ÇÅ‚üß ‚â°[ Tms‚â° Œò‚â° Œì‚â° ]‚â°·¥æ ‚ü¶‚®æ‚üß {‚ü¶Œì‚üß = ‚ü¶Œì‚ÇÇ‚üß} ‚ü¶Œ¥‚ÇÇ‚üß ‚ü¶œÉ‚ÇÇ‚üß
‚®æ‚â° refl refl refl Œ¥‚â° œÉ‚â° = {!!}

Œ†‚â° : ‚àÄ Œì‚â° A‚â° ‚Üí ‚ü¶B‚ÇÅ‚üß ‚â°[ Ty‚â° (‚ñ∑‚â° Œì‚â° A‚â°) ]‚â°·¥æ ‚ü¶B‚ÇÇ‚üß
     ‚Üí ‚ü¶Œ†‚üß ‚ü¶A‚ÇÅ‚üß ‚ü¶B‚ÇÅ‚üß ‚â°[ Ty‚â° Œì‚â° ]‚â°·¥æ ‚ü¶Œ†‚üß ‚ü¶A‚ÇÇ‚üß ‚ü¶B‚ÇÇ‚üß
Œ†‚â° refl refl refl = refl

‚ü¶TT‚üß : ‚ü¶Tm‚üß ‚ü¶Œì‚üß ‚ü¶ùîπ‚üß
‚ü¶TT‚üß _ _ = true

TT‚â° : (Œì‚â° : ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œì‚ÇÇ‚üß) ‚Üí ‚ü¶TT‚üß ‚â°[ Tm‚â° Œì‚â° (ùîπ‚â° Œì‚â°) ]‚â°·¥æ ‚ü¶TT‚üß 
TT‚â° refl = refl

‚ü¶FF‚üß : ‚ü¶Tm‚üß ‚ü¶Œì‚üß ‚ü¶ùîπ‚üß
‚ü¶FF‚üß _ _ = false

FF‚â° : (Œì‚â° : ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œì‚ÇÇ‚üß) ‚Üí ‚ü¶FF‚üß ‚â°[ Tm‚â° Œì‚â° (ùîπ‚â° Œì‚â°) ]‚â°·¥æ ‚ü¶FF‚üß 
FF‚â° refl = refl

‚ü¶∆õ‚üß : ‚ü¶Tm‚üß (‚ü¶‚ñ∑‚üß ‚ü¶Œì‚üß ‚ü¶A‚üß) ‚ü¶B‚üß ‚Üí ‚ü¶Tm‚üß ‚ü¶Œì‚üß (‚ü¶Œ†‚üß ‚ü¶A‚üß ‚ü¶B‚üß)
‚ü¶∆õ‚üß ‚ü¶t‚üß œá œÅ u‚±Ω = ‚ü¶t‚üß œá (œÅ Œ£, u‚±Ω)

∆õ‚â° : ‚àÄ (Œì‚â° : ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œì‚ÇÇ‚üß) 
       (A‚â° : ‚ü¶A‚ÇÅ‚üß ‚â°[ Ty‚â° {‚ü¶Œ®‚üß = ‚ü¶Œ®‚üß} Œì‚â° ]‚â°·¥æ ‚ü¶A‚ÇÇ‚üß)
       (B‚â° : ‚ü¶B‚ÇÅ‚üß ‚â°[ Ty‚â° (‚ñ∑‚â° Œì‚â° A‚â°) ]‚â°·¥æ ‚ü¶B‚ÇÇ‚üß)
   ‚Üí ‚ü¶t‚ÇÅ‚üß ‚â°[ Tm‚â° (‚ñ∑‚â° Œì‚â° A‚â°) B‚â° ]‚â°·¥æ ‚ü¶t‚ÇÇ‚üß
   ‚Üí ‚ü¶∆õ‚üß ‚ü¶t‚ÇÅ‚üß ‚â°[ Tm‚â° Œì‚â° (Œ†‚â° Œì‚â° A‚â° B‚â°) ]‚â°·¥æ ‚ü¶∆õ‚üß ‚ü¶t‚ÇÇ‚üß
∆õ‚â° refl refl refl refl = refl

‚ü¶∆õ‚Åª¬π‚üß : ‚ü¶Tm‚üß ‚ü¶Œì‚üß (‚ü¶Œ†‚üß ‚ü¶A‚üß ‚ü¶B‚üß) ‚Üí ‚ü¶Tm‚üß (‚ü¶‚ñ∑‚üß ‚ü¶Œì‚üß ‚ü¶A‚üß) ‚ü¶B‚üß
‚ü¶∆õ‚Åª¬π‚üß ‚ü¶t‚üß œá (œÅ Œ£, u‚±Ω) = ‚ü¶t‚üß œá œÅ u‚±Ω

∆õ‚Åª¬π‚â° : ‚àÄ {‚ü¶B‚ÇÇ‚üß ‚ü¶t‚ÇÇ‚üß} (Œì‚â° : ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œì‚ÇÇ‚üß) 
         (A‚â° : ‚ü¶A‚ÇÅ‚üß ‚â°[ Ty‚â° {‚ü¶Œ®‚üß = ‚ü¶Œ®‚üß} Œì‚â° ]‚â°·¥æ ‚ü¶A‚ÇÇ‚üß)
         (B‚â° : ‚ü¶B‚ÇÅ‚üß ‚â°[ Ty‚â° (‚ñ∑‚â° Œì‚â° A‚â°) ]‚â°·¥æ ‚ü¶B‚ÇÇ‚üß)
   ‚Üí ‚ü¶t‚ÇÅ‚üß ‚â°[ Tm‚â° Œì‚â° (Œ†‚â° Œì‚â° A‚â° B‚â°) ]‚â°·¥æ ‚ü¶t‚ÇÇ‚üß
   ‚Üí ‚ü¶∆õ‚Åª¬π‚üß ‚ü¶t‚ÇÅ‚üß ‚â°[ Tm‚â° (‚ñ∑‚â° Œì‚â° A‚â°) B‚â° ]‚â°·¥æ ‚ü¶∆õ‚Åª¬π‚üß ‚ü¶t‚ÇÇ‚üß
∆õ‚Åª¬π‚â° refl refl refl refl = refl

[]T‚â° : ‚àÄ {‚ü¶A‚ÇÅ‚üß : ‚ü¶Ty‚üß ‚ü¶Œì‚ÇÅ‚üß} {‚ü¶A‚ÇÇ‚üß : ‚ü¶Ty‚üß ‚ü¶Œì‚ÇÇ‚üß}
         {‚ü¶Œ¥‚ÇÅ‚üß : ‚ü¶Tms‚üß ‚ü¶Œî‚ÇÅ‚üß ‚ü¶Œì‚ÇÅ‚üß} {‚ü¶Œ¥‚ÇÇ‚üß : ‚ü¶Tms‚üß ‚ü¶Œî‚ÇÇ‚üß ‚ü¶Œì‚ÇÇ‚üß}
         Œì‚â° Œî‚â° ‚Üí ‚ü¶A‚ÇÅ‚üß ‚â°[ Ty‚â° Œì‚â° ]‚â°·¥æ ‚ü¶A‚ÇÇ‚üß ‚Üí ‚ü¶Œ¥‚ÇÅ‚üß ‚â°[ Tms‚â° Œî‚â° Œì‚â° ]‚â°·¥æ ‚ü¶Œ¥‚ÇÇ‚üß
     ‚Üí ‚ü¶[]T‚üß ‚ü¶A‚ÇÅ‚üß ‚ü¶Œ¥‚ÇÅ‚üß ‚â°[ Ty‚â° Œî‚â° ]‚â°·¥æ ‚ü¶[]T‚üß ‚ü¶A‚ÇÇ‚üß ‚ü¶Œ¥‚ÇÇ‚üß
[]T‚â° refl refl refl Œ¥‚â° = {!!}

wkeq‚â° : ‚àÄ (Œì‚â° : ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œì‚ÇÇ‚üß) (t‚â° : ‚ü¶t‚ÇÅ‚üß ‚â°[ Tm‚â° {‚ü¶Œ®‚üß = ‚ü¶Œ®‚üß} Œì‚â° (ùîπ‚â° Œì‚â°) ]‚â°·¥æ ‚ü¶t‚ÇÇ‚üß) 
      ‚Üí ‚ü¶wkeq‚üß ‚â°[ Tms‚â°  (‚ñ∑>eq‚â° {b = b} Œì‚â° t‚â°) Œì‚â° ]‚â°·¥æ ‚ü¶wkeq‚üß
wkeq‚â° refl refl = refl

‚ü¶if‚üß : ‚àÄ ‚ü¶t‚üß 
     ‚Üí ‚ü¶Tm‚üß (‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚üß ‚ü¶t‚üß true)  (‚ü¶[]T‚üß ‚ü¶A‚üß ‚ü¶wkeq‚üß)
     ‚Üí ‚ü¶Tm‚üß (‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚üß ‚ü¶t‚üß false) (‚ü¶[]T‚üß ‚ü¶A‚üß ‚ü¶wkeq‚üß)
     ‚Üí ‚ü¶Tm‚üß ‚ü¶Œì‚üß ‚ü¶A‚üß
‚ü¶if‚üß ‚ü¶t‚üß ‚ü¶u‚üß ‚ü¶v‚üß 
  = Œª œá œÅ ‚Üí Bool-split·¥æ (‚ü¶t‚üß œá œÅ) 
                        (Œª t~ ‚Üí ‚ü¶u‚üß œá (œÅ Œ£, box t~)) 
                        (Œª t~ ‚Üí ‚ü¶v‚üß œá (œÅ Œ£, box t~)) 

if‚â° : ‚àÄ (Œì‚â° : ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œì‚ÇÇ‚üß) (A‚â° : ‚ü¶A‚ÇÅ‚üß ‚â°[ Ty‚â° {‚ü¶Œ®‚üß = ‚ü¶Œ®‚üß} Œì‚â° ]‚â°·¥æ ‚ü¶A‚ÇÇ‚üß) 
        (t‚â° : ‚ü¶t‚ÇÅ‚üß ‚â°[ Tm‚â° Œì‚â° (ùîπ‚â° Œì‚â°) ]‚â°·¥æ ‚ü¶t‚ÇÇ‚üß)
    ‚Üí ‚ü¶u‚ÇÅ‚üß ‚â°[ Tm‚â° (‚ñ∑>eq‚â° Œì‚â° t‚â°) ([]T‚â° Œì‚â° (‚ñ∑>eq‚â° Œì‚â° t‚â°) A‚â° (wkeq‚â° Œì‚â° t‚â°)) 
           ]‚â°·¥æ ‚ü¶u‚ÇÇ‚üß
    ‚Üí ‚ü¶v‚ÇÅ‚üß ‚â°[ Tm‚â° (‚ñ∑>eq‚â° Œì‚â° t‚â°) ([]T‚â° Œì‚â° (‚ñ∑>eq‚â° Œì‚â° t‚â°) A‚â° (wkeq‚â° Œì‚â° t‚â°)) 
           ]‚â°·¥æ ‚ü¶v‚ÇÇ‚üß
    ‚Üí ‚ü¶if‚üß ‚ü¶t‚ÇÅ‚üß ‚ü¶u‚ÇÅ‚üß ‚ü¶v‚ÇÅ‚üß ‚â°[ Tm‚â° Œì‚â° A‚â° ]‚â°·¥æ ‚ü¶if‚üß ‚ü¶t‚ÇÇ‚üß ‚ü¶u‚ÇÇ‚üß ‚ü¶v‚ÇÇ‚üß
if‚â° refl refl refl refl refl = refl

‚ü¶[]t‚üß : ‚ü¶Tm‚üß ‚ü¶Œì‚üß ‚ü¶A‚üß ‚Üí ‚àÄ (‚ü¶Œ¥‚üß : ‚ü¶Tms‚üß ‚ü¶Œî‚üß ‚ü¶Œì‚üß) ‚Üí ‚ü¶Tm‚üß ‚ü¶Œî‚üß (‚ü¶[]T‚üß ‚ü¶A‚üß ‚ü¶Œ¥‚üß)
‚ü¶[]t‚üß ‚ü¶t‚üß (‚ü¶Œ¥‚üß Œ£, ‚ü¶Œ¥‚üß‚Ä≤) = Œª œá œÅ ‚Üí ‚ü¶t‚üß (‚ü¶Œ¥‚üß œá) (‚ü¶Œ¥‚üß‚Ä≤ œÅ)

-- TODO: Generalise further?
[]C‚â° : ‚àÄ (Œ¶‚â° : ‚ü¶Œ¶‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œ¶‚ÇÇ‚üß)
     ‚Üí ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œì‚ÇÇ‚üß ‚Üí ‚ü¶Œ≥‚ÇÅ‚üß ‚â°[ Wk‚â° Œ¶‚â° refl ]‚â°·¥æ ‚ü¶Œ≥‚ÇÇ‚üß
     ‚Üí ‚ü¶[]C‚üß ‚ü¶Œì‚ÇÅ‚üß ‚ü¶Œ≥‚ÇÅ‚üß ‚â°[ Ctx‚â° Œ¶‚â° ]‚â°·¥æ ‚ü¶[]C‚üß ‚ü¶Œì‚ÇÇ‚üß ‚ü¶Œ≥‚ÇÇ‚üß
[]C‚â° refl refl refl = refl

‚åú‚åùùíÆ‚â° : ‚àÄ {‚ü¶Œ≥‚ÇÅ‚üß : ‚ü¶Wk‚üß ‚ü¶Œ¶‚ÇÅ‚üß ‚ü¶Œ®‚ÇÅ‚üß} 
         (Œ¶‚â° : ‚ü¶Œ¶‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œ¶‚ÇÇ‚üß) (Œ® : ‚ü¶Œ®‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œ®‚ÇÇ‚üß) 
         (Œ≥‚â° : ‚ü¶Œ≥‚ÇÅ‚üß ‚â°[ Wk‚â° Œ¶‚â° Œ®‚â° ]‚â°·¥æ ‚ü¶Œ≥‚ÇÇ‚üß) 
     ‚Üí ‚ü¶‚åú‚åùùíÆ‚üß {‚ü¶Œì‚üß = ‚ü¶Œì‚üß} ‚ü¶Œ≥‚ÇÅ‚üß 
     ‚â°[ Tms‚â°‚Ä≤ {‚ü¶Œì‚ÇÅ‚üß = ‚ü¶Œì‚üß} Œ¶‚â° Œ®‚â° ([]C‚â° {‚ü¶Œì‚ÇÅ‚üß = ‚ü¶Œì‚üß} Œ¶‚â° refl Œ≥‚â°) refl 
     ]‚â°·¥æ ‚ü¶‚åú‚åùùíÆ‚üß {‚ü¶Œì‚üß = ‚ü¶Œì‚üß} ‚ü¶Œ≥‚ÇÇ‚üß
‚åú‚åùùíÆ‚â°  refl refl refl = refl

Ty‚â°-inst : ‚àÄ {œá : ‚ü¶Œ®‚üß} {œÅ : ‚ü¶Œì‚üß œá} ‚Üí ‚ü¶A‚ÇÅ‚üß ‚â°·¥æ ‚ü¶A‚ÇÇ‚üß ‚Üí ‚ü¶A‚ÇÅ‚üß œá œÅ ‚â°·¥æ ‚ü¶A‚ÇÇ‚üß œá œÅ
Ty‚â°-inst refl = refl

Tm‚â°-inst : ‚àÄ {œá : ‚ü¶Œ®‚üß} {œÅ : ‚ü¶Œì‚üß œá} ‚Üí ‚ü¶t‚ÇÅ‚üß ‚â°·¥æ ‚ü¶t‚ÇÇ‚üß ‚Üí ‚ü¶t‚ÇÅ‚üß œá œÅ ‚â°·¥æ ‚ü¶t‚ÇÇ‚üß œá œÅ
Tm‚â°-inst refl = refl

Tm[]‚â°-inst : ‚àÄ {œá : ‚ü¶Œ®‚üß} {œÅ : ‚ü¶Œì‚üß œá} (A‚â° : ‚ü¶A‚ÇÅ‚üß ‚â°·¥æ ‚ü¶A‚ÇÇ‚üß) 
           ‚Üí ‚ü¶t‚ÇÅ‚üß ‚â°[ Tm‚â° refl A‚â° ]‚â°·¥æ ‚ü¶t‚ÇÇ‚üß 
           ‚Üí ‚ü¶t‚ÇÅ‚üß œá œÅ ‚â°[ Ty‚â°-inst A‚â° ]‚â°·¥æ ‚ü¶t‚ÇÇ‚üß œá œÅ
Tm[]‚â°-inst refl refl = refl

‚ü¶,eq‚üß : ‚àÄ (‚ü¶Œ¥‚üß : ‚ü¶Tms‚üß ‚ü¶Œî‚üß ‚ü¶Œì‚üß) ‚Üí ‚ü¶[]t‚üß ‚ü¶t‚üß ‚ü¶Œ¥‚üß ‚â°·¥æ (Œª œá œÅ ‚Üí b)
      ‚Üí ‚ü¶Tms‚üß ‚ü¶Œî‚üß (‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚üß ‚ü¶t‚üß b)
‚ü¶,eq‚üß (‚ü¶Œ¥‚üß Œ£, ‚ü¶Œ¥‚üß‚Ä≤) t‚â° = ‚ü¶Œ¥‚üß Œ£, Œª œÅ ‚Üí ‚ü¶Œ¥‚üß‚Ä≤ œÅ Œ£, box (Tm‚â°-inst t‚â°)

‚ü¶_‚üßSig : Sig ‚Üí ‚ü¶Sig‚üß
‚ü¶_‚üßCtx : Ctx Œ® ‚Üí ‚ü¶Ctx‚üß ‚ü¶ Œ® ‚üßSig
‚ü¶_‚üßTy  : Ty Œì ‚Üí ‚ü¶Ty‚üß ‚ü¶ Œì ‚üßCtx
‚ü¶_‚üßTm  : Tm Œì A ‚Üí ‚ü¶Tm‚üß ‚ü¶ Œì ‚üßCtx ‚ü¶ A ‚üßTy
‚ü¶_‚üßWk  : Wk Œ¶ Œ® ‚Üí ‚ü¶Wk‚üß ‚ü¶ Œ¶ ‚üßSig ‚ü¶ Œ® ‚üßSig 
‚ü¶_‚üßTms : Tms Œî Œì ‚Üí ‚ü¶Tms‚üß ‚ü¶ Œî ‚üßCtx ‚ü¶ Œì ‚üßCtx

variable
  œá œá‚ÇÅ œá‚ÇÇ : ‚ü¶Œ®‚üß
  œÅ œÅ‚ÇÅ œÅ‚ÇÇ : ‚ü¶Œì‚üß œá

‚ü¶_‚üßCtx~ : Ctx~ Œì‚ÇÅ Œì‚ÇÇ ‚Üí ‚ü¶ Œì‚ÇÅ ‚üßCtx ‚â°·¥æ ‚ü¶ Œì‚ÇÇ ‚üßCtx
‚ü¶_‚üßTy~  : Ty~ Œì~ A‚ÇÅ A‚ÇÇ ‚Üí ‚ü¶ A‚ÇÅ ‚üßTy ‚â°[ cong·¥æ ‚ü¶Ty‚üß ‚ü¶ Œì~ ‚üßCtx~ ]‚â°·¥æ ‚ü¶ A‚ÇÇ ‚üßTy
‚ü¶_‚üßTm~  : Tm~ Œì~ A~ t‚ÇÅ t‚ÇÇ 
        ‚Üí ‚ü¶ t‚ÇÅ ‚üßTm ‚â°[ Tm‚â° ‚ü¶ Œì~ ‚üßCtx~ ‚ü¶ A~ ‚üßTy~ ]‚â°·¥æ ‚ü¶ t‚ÇÇ ‚üßTm
‚ü¶‚üßWk~   : ‚ü¶ Œæ‚ÇÅ ‚üßWk ‚â°·¥æ ‚ü¶ Œæ‚ÇÇ ‚üßWk
‚ü¶_‚üßTms~ : Tms~ Œî~ Œì~ Œ¥‚ÇÅ Œ¥‚ÇÇ 
        ‚Üí ‚ü¶ Œ¥‚ÇÅ ‚üßTms ‚â°[ Tms‚â° ‚ü¶ Œî~ ‚üßCtx~ ‚ü¶ Œì~ ‚üßCtx~ ]‚â°·¥æ ‚ü¶ Œ¥‚ÇÇ ‚üßTms

‚ü¶ùîπ‚üß‚Ä≤ : ‚ü¶ ùîπ {Œì = Œì} ‚üßTy ‚â°·¥æ Œª œá œÅ ‚Üí Bool 

‚ü¶‚ñ∑>eq‚üß‚Ä≤ : ‚àÄ (Œì : Ctx Œ®) ‚Üí ‚ü¶Tm‚üß ‚ü¶ Œì ‚üßCtx ‚ü¶ ùîπ ‚üßTy ‚Üí Bool ‚Üí ‚ü¶Ctx‚üß ‚ü¶ Œ® ‚üßSig

‚ü¶ ‚Ä¢           ‚üßCtx = Œª œá ‚Üí ‚ä§
‚ü¶ Œì ‚ñ∑ A       ‚üßCtx = Œª œá ‚Üí Œ£ (‚ü¶ Œì ‚üßCtx œá) (Œª œÅ ‚Üí ‚ü¶ A ‚üßTy œá œÅ)
‚ü¶ Œì ‚ñ∑ t >eq b ‚üßCtx = ‚ü¶‚ñ∑>eq‚üß‚Ä≤ Œì ‚ü¶ t ‚üßTm b
‚ü¶ Œì [ Œ¥ ]     ‚üßCtx = Œª œá ‚Üí ‚ü¶ Œì ‚üßCtx (‚ü¶ Œ¥ ‚üßWk œá)


‚ü¶ coe~ Œì~ A ‚üßTy = coe·¥æ (Ty‚â° ‚ü¶ Œì~ ‚üßCtx~) ‚ü¶ A ‚üßTy
‚ü¶ ùîπ         ‚üßTy = ‚ü¶ùîπ‚üß
‚ü¶ Œ† A B     ‚üßTy = Œª œá œÅ ‚Üí ‚àÄ t‚±Ω ‚Üí ‚ü¶ B ‚üßTy œá (œÅ Œ£, t‚±Ω)
‚ü¶ A [ Œ¥ ]   ‚üßTy = ‚ü¶[]T‚üß ‚ü¶ A ‚üßTy ‚ü¶ Œ¥ ‚üßTms
‚ü¶ if t A B  ‚üßTy = Œª œá œÅ ‚Üí Bool-rec (‚ü¶ t ‚üßTm œá œÅ) (‚ü¶ A ‚üßTy œá œÅ) (‚ü¶ B ‚üßTy œá œÅ)

‚ü¶‚ñ∑>eq‚üß‚Ä≤ Œì ‚ü¶t‚üß b = ‚ü¶‚ñ∑>eq‚üß ‚ü¶ Œì ‚üßCtx ‚ü¶t‚üß b


‚ü¶TT‚üß‚Ä≤ : ‚ü¶ TT {Œì = Œì} ‚üßTm ‚â°·¥æ Œª œá œÅ ‚Üí true
‚ü¶FF‚üß‚Ä≤ : ‚ü¶ FF {Œì = Œì} ‚üßTm ‚â°·¥æ Œª œá œÅ ‚Üí false
‚ü¶[]‚üß‚Ä≤ : ‚àÄ {t : Tm Œì A} {Œ¥ : Tms {Œ¶ = Œ¶} {Œ® = Œ®} Œî Œì} 
      ‚Üí ‚ü¶ t [ Œ¥ ] ‚üßTm 
      ‚â°·¥æ Œª œá œÅ ‚Üí ‚ü¶ t ‚üßTm (‚ü¶ Œ¥ ‚üßTms .fst œá) (‚ü¶ Œ¥ ‚üßTms .snd œÅ)

‚ü¶wkùíÆ‚üß‚Ä≤ : ‚ü¶ Œ® ‚ñ∑ Œì ‚áí A if t then u else v ‚üßSig ‚Üí ‚ü¶ Œ® ‚üßSig

‚ü¶ id    ‚üßWk = ‚ü¶idùíÆ‚üß
‚ü¶ Œ¥ ‚®æ œÉ ‚üßWk = Œª œá ‚Üí ‚ü¶ Œ¥ ‚üßWk (‚ü¶ œÉ ‚üßWk œá)
‚ü¶ wkùíÆ   ‚üßWk = ‚ü¶wkùíÆ‚üß‚Ä≤

‚ü¶,eq‚üß‚Ä≤ : ‚àÄ (Œ¥ : Tms {Œ¶ = Œ¶} {Œ® = Œ®} Œî Œì) {t : Tm Œì ùîπ} 
           œá (œÅ : ‚ü¶ Œî ‚üßCtx œá) 
       ‚Üí ‚ü¶[]t‚üß ‚ü¶ t ‚üßTm ‚ü¶ Œ¥ ‚üßTms œá œÅ ‚â°·¥æ b
       ‚Üí ‚ü¶[]C‚üß (‚ü¶‚ñ∑>eq‚üß ‚ü¶ Œì ‚üßCtx ‚ü¶ t ‚üßTm b) (‚ü¶ Œ¥ ‚üßTms .fst) œá

‚ü¶ coe~ Œî~ Œì~ Œ¥ ‚üßTms = coe·¥æ (Tms‚â° ‚ü¶ Œî~ ‚üßCtx~ ‚ü¶ Œì~ ‚üßCtx~) ‚ü¶ Œ¥ ‚üßTms
‚ü¶ œÄ‚ÇÅ Œ¥         ‚üßTms = ‚ü¶ Œ¥ ‚üßTms .fst Œ£, Œª œÅ ‚Üí ‚ü¶ Œ¥ ‚üßTms .snd œÅ .fst
‚ü¶ id           ‚üßTms = ‚ü¶id‚üß
‚ü¶ œÄ‚ÇÅeq {t = t} Œ¥ ‚üßTms = ‚ü¶œÄ‚ÇÅeq‚üß {‚ü¶t‚üß = ‚ü¶ t ‚üßTm} ‚ü¶ Œ¥ ‚üßTms            
‚ü¶ Œµ            ‚üßTms = ‚ü¶idùíÆ‚üß Œ£, Œª œÅ ‚Üí tt
‚ü¶ Œ¥ , t ‚üßTms        = ‚ü¶ Œ¥ ‚üßTms .fst Œ£, Œª œÅ ‚Üí ‚ü¶ Œ¥ ‚üßTms .snd œÅ Œ£, ‚ü¶ t ‚üßTm _ œÅ
‚ü¶ ,eq‚Ñ± {b = true} Œ¥ {u = u} refl t~ ‚üßTms 
  with sym·¥æ (‚ü¶[]‚üß‚Ä≤ {Œ¥ = Œ¥}) ‚àô·¥æ ‚ü¶ t~ ‚üßTm~ ‚àô·¥æ ‚ü¶TT‚üß‚Ä≤
... | t‚â° = ‚ü¶ Œ¥ ‚üßTms .fst Œ£, Œª œÅ ‚Üí ‚ü¶,eq‚üß‚Ä≤ Œ¥ _ œÅ (Tm‚â°-inst t‚â°)
‚ü¶ ,eq‚Ñ± {b = false} Œ¥ {u = u} refl t~ ‚üßTms 
  with sym·¥æ (‚ü¶[]‚üß‚Ä≤ {Œ¥ = Œ¥}) ‚àô·¥æ ‚ü¶ t~ ‚üßTm~ ‚àô·¥æ ‚ü¶FF‚üß‚Ä≤
... | t‚â° = ‚ü¶ Œ¥ ‚üßTms .fst Œ£, Œª œÅ ‚Üí ‚ü¶,eq‚üß‚Ä≤ Œ¥ _ œÅ (Tm‚â°-inst t‚â°)
‚ü¶ Œ¥ ‚®æ œÉ ‚üßTms = _ Œ£, Œª œÅ ‚Üí ‚ü¶ Œ¥ ‚üßTms .snd (‚ü¶ œÉ ‚üßTms .snd œÅ)
‚ü¶ wkùíÆ ‚üßTms = ‚ü¶wkùíÆ‚üß‚Ä≤ Œ£, Œª œÅ ‚Üí œÅ

‚ü¶ ‚Ä¢                               ‚üßSig = ‚ä§
‚ü¶ Œ® ‚ñ∑  Œì ‚áí A if t then u else v   ‚üßSig
  = ‚ü¶‚ñ∑ùíÆ‚üß ‚ü¶ Œ® ‚üßSig ‚ü¶ Œì ‚üßCtx ‚ü¶ A ‚üßTy ‚ü¶ t ‚üßTm ‚ü¶ u ‚üßTm ‚ü¶ v ‚üßTm

‚ü¶wkùíÆ‚üß‚Ä≤ (œá Œ£, f) = œá

‚ü¶ coe~ Œì~ A~ t ‚üßTm = coe·¥æ (Tm‚â° ‚ü¶ Œì~ ‚üßCtx~ ‚ü¶ A~ ‚üßTy~) ‚ü¶ t ‚üßTm

‚ü¶ ∆õ t     ‚üßTm = Œª œá œÅ u‚±Ω ‚Üí ‚ü¶ t ‚üßTm œá (œÅ Œ£, u‚±Ω)
‚ü¶ ∆õ‚Åª¬π t   ‚üßTm = Œª œá (œÅ Œ£, u‚±Ω)   ‚Üí ‚ü¶ t ‚üßTm œá œÅ u‚±Ω
‚ü¶ TT      ‚üßTm = Œª œá œÅ          ‚Üí true
‚ü¶ FF      ‚üßTm = Œª œá œÅ          ‚Üí false
‚ü¶ t [ Œ¥ ] ‚üßTm = ‚ü¶[]t‚üß ‚ü¶ t ‚üßTm ‚ü¶ Œ¥ ‚üßTms
‚ü¶ œÄ‚ÇÇ Œ¥  ‚üßTm = Œª œá œÅ ‚Üí ‚ü¶ Œ¥ ‚üßTms .snd œÅ .snd
‚ü¶ call {A = A} ‚üßTm (œá Œ£, f) œÅ 
  = f .fst œÅ

‚ü¶,eq‚üß‚Ä≤ {b = b} Œ¥ œá œÅ t‚â° = ‚ü¶ Œ¥ ‚üßTms .snd œÅ Œ£, box t‚â°

‚ü¶TT‚üß‚Ä≤ = refl
‚ü¶FF‚üß‚Ä≤ = refl
‚ü¶[]‚üß‚Ä≤ = refl

‚ü¶ùîπ‚üß‚Ä≤ = refl

‚ü¶‚åú‚åùùíÆ‚üß‚â° : ‚àÄ {‚åúŒæ‚åù} ‚Üí ‚åúŒæ‚åù ‚â°·¥æ ‚åú_‚åùùíÆ {Œì = Œì} Œæ
       ‚Üí ‚ü¶ ‚åúŒæ‚åù ‚üßTms ‚â°·¥æ ‚ü¶‚åú‚åùùíÆ‚üß {‚ü¶Œì‚üß = ‚ü¶ Œì ‚üßCtx} ‚ü¶ Œæ ‚üßWk
‚ü¶‚åú‚åùùíÆ‚üß‚â° {Œæ = id} refl = refl
‚ü¶‚åú‚åùùíÆ‚üß‚â° {Œì = Œì} {Œæ = œÜ ‚®æ œà} refl
  = ‚®æ‚â° (refl {x = ‚ü¶ Œì ‚üßCtx}) refl refl 
       (‚ü¶‚åú‚åùùíÆ‚üß‚â° {Œæ = œÜ} refl) (‚ü¶‚åú‚åùùíÆ‚üß‚â° {Œæ = œà} refl)
‚ü¶‚åú‚åùùíÆ‚üß‚â° {Œæ = wkùíÆ} refl = refl

-- I'm not immediately sure how to prove this, but it is obviously true
-- Perhaps this would be easier if we enforced that |Wk| in the model was
-- unique (rather than an arbitrary function between signatures, we could use a
-- first-order representation) but I think losing functor laws would be 
-- kinda miserable
wk-uniq : ‚àÄ {Œæ‚ÇÅ Œæ‚ÇÇ : Wk œá Œ®} ‚Üí ‚ü¶ Œæ‚ÇÅ ‚üßWk ‚â°·¥æ ‚ü¶ Œæ‚ÇÇ ‚üßWk
wk-uniq = {!!}
 
‚ü¶ rfl~         ‚üßCtx~ = refl
‚ü¶ sym~ Œì~      ‚üßCtx~ = sym·¥æ ‚ü¶ Œì~ ‚üßCtx~
‚ü¶ Œì‚ÇÅ‚ÇÇ~ ‚àô~ Œì‚ÇÇ‚ÇÉ~ ‚üßCtx~ = ‚ü¶ Œì‚ÇÅ‚ÇÇ~ ‚üßCtx~ ‚àô·¥æ ‚ü¶ Œì‚ÇÇ‚ÇÉ~ ‚üßCtx~
‚ü¶ Œì~ ‚ñ∑ A~      ‚üßCtx~ = ‚ñ∑‚â° ‚ü¶ Œì~ ‚üßCtx~ ‚ü¶ A~ ‚üßTy~
‚ü¶ Œì~ ‚ñ∑ t~ >eq  ‚üßCtx~ = ‚ñ∑>eq‚â° ‚ü¶ Œì~ ‚üßCtx~ ‚ü¶ t~ ‚üßTm~
‚ü¶ _[] {Œæ‚ÇÅ = Œæ‚ÇÅ} {Œæ‚ÇÇ = Œæ‚ÇÇ} Œì~ ‚üßCtx~ 
  = []C‚â° refl ‚ü¶ Œì~ ‚üßCtx~ (wk-uniq {Œæ‚ÇÅ = Œæ‚ÇÅ} {Œæ‚ÇÇ = Œæ‚ÇÇ})
‚ü¶ ‚Ä¢[] ‚üßCtx~ = refl
‚ü¶ ‚ñ∑[]‚Ñ± {Œæ = Œæ} {A = A} refl ‚üßCtx~ 
  = ‚ñ∑‚â° refl ([]T‚â° refl refl (refl {x = ‚ü¶ A ‚üßTy}) (sym·¥æ (‚ü¶‚åú‚åùùíÆ‚üß‚â° {Œæ = Œæ} refl)))
‚ü¶ ‚ñ∑>eq[] ‚üßCtx~ = {!  !}
‚ü¶ [id] ‚üßCtx~ = refl
‚ü¶ [][] ‚üßCtx~ = refl

‚ü¶ rfl~              ‚üßTy~ = refl
‚ü¶ sym~ A~           ‚üßTy~ = sym[]·¥æ ‚ü¶ A~ ‚üßTy~
‚ü¶ A‚ÇÅ‚ÇÇ~ ‚àô~ A‚ÇÇ‚ÇÉ~      ‚üßTy~ = ‚ü¶ A‚ÇÅ‚ÇÇ~ ‚üßTy~ ‚àô[]·¥æ ‚ü¶ A‚ÇÇ‚ÇÉ~ ‚üßTy~
‚ü¶ coh               ‚üßTy~ = coh[]·¥æ
‚ü¶ ùîπ {Œì~ = Œì~}       ‚üßTy~ = ùîπ‚â° ‚ü¶ Œì~ ‚üßCtx~
‚ü¶ Œ† {Œì~ = Œì~} A~ B~ ‚üßTy~ = Œ†‚â° ‚ü¶ Œì~ ‚üßCtx~ ‚ü¶ A~ ‚üßTy~ ‚ü¶ B~ ‚üßTy~
‚ü¶ _[_] {Œì~ = Œì~} {Œî~ = Œî~} A~ Œ¥~ ‚üßTy~ 
  = []T‚â° ‚ü¶ Œì~ ‚üßCtx~ ‚ü¶ Œî~ ‚üßCtx~ ‚ü¶ A~ ‚üßTy~ ‚ü¶ Œ¥~ ‚üßTms~
‚ü¶ if t~ A~ B~ ‚üßTy~ = {!   !}

‚ü¶ ifTT              ‚üßTy~ = refl
‚ü¶ ifFF              ‚üßTy~ = refl
‚ü¶ Œ†[]               ‚üßTy~ = refl
‚ü¶ if[]              ‚üßTy~ = refl
‚ü¶ ùîπ[]               ‚üßTy~ = refl
‚ü¶ [][]              ‚üßTy~ = refl
‚ü¶ [id]              ‚üßTy~ = refl

-- Specialisation of |coh[]·¥æ| to assist with termination
cohTm : ‚àÄ {‚ü¶t‚üß : ‚ü¶Tm‚üß {‚ü¶Œ®‚üß = ‚ü¶Œ®‚üß} ‚ü¶Œì‚ÇÅ‚üß ‚ü¶A‚ÇÅ‚üß} {Œì‚â° : ‚ü¶Œì‚ÇÅ‚üß ‚â°·¥æ ‚ü¶Œì‚ÇÇ‚üß} 
          {A‚â° : ‚ü¶A‚ÇÅ‚üß ‚â°[ Ty‚â° Œì‚â° ]‚â°·¥æ ‚ü¶A‚ÇÇ‚üß} 
      ‚Üí ‚ü¶t‚üß ‚â°[ Tm‚â° Œì‚â° A‚â° ]‚â°·¥æ coe·¥æ (Tm‚â° Œì‚â° A‚â°) ‚ü¶t‚üß
cohTm {Œì‚â° = refl} {A‚â° = refl} = refl

call-TT‚â° : ‚àÄ {‚ü¶t‚üß : ‚ü¶Tm‚üß {‚ü¶Œ®‚üß = ‚ü¶Œ®‚üß} ‚ü¶Œì‚üß ‚ü¶ùîπ‚üß}  {‚ü¶A‚üß}
             {‚ü¶u‚üß : ‚ü¶Tm‚üß (‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚üß _ _) (‚ü¶[]T‚üß ‚ü¶A‚üß ‚ü¶wkeq‚üß)} 
             {‚ü¶v‚üß : ‚ü¶Tm‚üß (‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚üß _ _) (‚ü¶[]T‚üß ‚ü¶A‚üß ‚ü¶wkeq‚üß)} 
             {‚ü¶Œ¥‚üß : ‚ü¶Tms‚üß {‚ü¶Œ¶‚üß = ‚ü¶Œ¶‚üß} ‚ü¶Œî‚üß 
                          (‚ü¶[]C‚üß ‚ü¶Œì‚üß (‚ü¶wkùíÆ‚üß {‚ü¶A‚üß = ‚ü¶A‚üß} {‚ü¶t‚üß = ‚ü¶t‚üß}))} 
             (t‚â° : ‚ü¶[]t‚üß ‚ü¶t‚üß (‚ü¶‚®æ‚üß {‚ü¶Œì‚üß = ‚ü¶Œì‚üß} (‚ü¶‚åú‚åùùíÆ‚üß {‚ü¶Œì‚üß = ‚ü¶Œì‚üß} ‚ü¶wkùíÆ‚üß) ‚ü¶Œ¥‚üß) 
                 ‚â°·¥æ ‚ü¶TT‚üß)
             ‚Üí ‚ü¶[]t‚üß (‚ü¶call‚üß {‚ü¶u‚üß = ‚ü¶u‚üß} {‚ü¶v‚üß = ‚ü¶v‚üß}) ‚ü¶Œ¥‚üß  
             ‚â°·¥æ ‚ü¶[]t‚üß ‚ü¶u‚üß (‚ü¶‚®æ‚üß {‚ü¶Œì‚üß = ‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚üß ‚ü¶t‚üß _}
                      (‚ü¶‚åú‚åùùíÆ‚üß {‚ü¶Œì‚üß = ‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚üß ‚ü¶t‚üß _} (‚ü¶wkùíÆ‚üß )) 
                      (‚ü¶,eq‚üß {‚ü¶Œì‚üß = ‚ü¶[]C‚üß ‚ü¶Œì‚üß ‚ü¶wkùíÆ‚üß} 
                             {‚ü¶t‚üß = ‚ü¶[]t‚üß ‚ü¶t‚üß (‚ü¶‚åú‚åùùíÆ‚üß ‚ü¶wkùíÆ‚üß)} ‚ü¶Œ¥‚üß t‚â°))
call-TT‚â° {‚ü¶Œ¥‚üß = ‚ü¶Œ¥‚üß} t‚â° 
  = funext·¥æ Œª œá ‚Üí funext·¥æ Œª œÅ ‚Üí 
      let (œÜ‚Ä≤ Œ£, (f Œ£, fTT Œ£, fFF)) = ‚ü¶Œ¥‚üß .fst œá
          œÅ‚Ä≤ = ‚ü¶Œ¥‚üß .snd œÅ
      in unbox (fTT œÅ‚Ä≤ (Tm‚â°-inst t‚â°))

call-FF‚â° : ‚àÄ {‚ü¶t‚üß : ‚ü¶Tm‚üß {‚ü¶Œ®‚üß = ‚ü¶Œ®‚üß} ‚ü¶Œì‚üß ‚ü¶ùîπ‚üß}  {‚ü¶A‚üß}
             {‚ü¶u‚üß : ‚ü¶Tm‚üß (‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚üß _ _) (‚ü¶[]T‚üß ‚ü¶A‚üß ‚ü¶wkeq‚üß)} 
             {‚ü¶v‚üß : ‚ü¶Tm‚üß (‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚üß _ _) (‚ü¶[]T‚üß ‚ü¶A‚üß ‚ü¶wkeq‚üß)} 
             {‚ü¶Œ¥‚üß : ‚ü¶Tms‚üß {‚ü¶Œ¶‚üß = ‚ü¶Œ¶‚üß} ‚ü¶Œî‚üß 
                          (‚ü¶[]C‚üß ‚ü¶Œì‚üß (‚ü¶wkùíÆ‚üß {‚ü¶A‚üß = ‚ü¶A‚üß} {‚ü¶t‚üß = ‚ü¶t‚üß}))} 
             (t‚â° : ‚ü¶[]t‚üß ‚ü¶t‚üß (‚ü¶‚®æ‚üß {‚ü¶Œì‚üß = ‚ü¶Œì‚üß} (‚ü¶‚åú‚åùùíÆ‚üß {‚ü¶Œì‚üß = ‚ü¶Œì‚üß} ‚ü¶wkùíÆ‚üß) ‚ü¶Œ¥‚üß) 
                 ‚â°·¥æ ‚ü¶FF‚üß)
             ‚Üí ‚ü¶[]t‚üß (‚ü¶call‚üß {‚ü¶u‚üß = ‚ü¶u‚üß} {‚ü¶v‚üß = ‚ü¶v‚üß}) ‚ü¶Œ¥‚üß  
             ‚â°·¥æ ‚ü¶[]t‚üß ‚ü¶v‚üß (‚ü¶‚®æ‚üß {‚ü¶Œì‚üß = ‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚üß ‚ü¶t‚üß _}
                      (‚ü¶‚åú‚åùùíÆ‚üß {‚ü¶Œì‚üß = ‚ü¶‚ñ∑>eq‚üß ‚ü¶Œì‚üß ‚ü¶t‚üß _} (‚ü¶wkùíÆ‚üß )) 
                      (‚ü¶,eq‚üß {‚ü¶Œì‚üß = ‚ü¶[]C‚üß ‚ü¶Œì‚üß ‚ü¶wkùíÆ‚üß} 
                             {‚ü¶t‚üß = ‚ü¶[]t‚üß ‚ü¶t‚üß (‚ü¶‚åú‚åùùíÆ‚üß ‚ü¶wkùíÆ‚üß)} ‚ü¶Œ¥‚üß t‚â°))
call-FF‚â° {‚ü¶Œ¥‚üß = ‚ü¶Œ¥‚üß} t‚â° 
  = funext·¥æ Œª œá ‚Üí funext·¥æ Œª œÅ ‚Üí 
      let (œÜ‚Ä≤ Œ£, (f Œ£, fTT Œ£, fFF)) = ‚ü¶Œ¥‚üß .fst œá
          œÅ‚Ä≤ = ‚ü¶Œ¥‚üß .snd œÅ
      in unbox (fFF œÅ‚Ä≤ (Tm‚â°-inst t‚â°))

‚ü¶ rfl~         ‚üßTm~ = refl
‚ü¶ sym~ t~      ‚üßTm~ = sym[]·¥æ ‚ü¶ t~ ‚üßTm~
‚ü¶ t‚ÇÅ‚ÇÇ~ ‚àô~ t‚ÇÇ‚ÇÉ~ ‚üßTm~ = ‚ü¶ t‚ÇÅ‚ÇÇ~ ‚üßTm~ ‚àô[]·¥æ ‚ü¶ t‚ÇÇ‚ÇÉ~ ‚üßTm~

‚ü¶ coh {Œì~ = Œì~} {A~ = A~} ‚üßTm~ = cohTm {Œì‚â° = ‚ü¶ Œì~ ‚üßCtx~} {A‚â° = ‚ü¶ A~ ‚üßTy~}

‚ü¶ ∆õ_ {Œì~ = Œì~} {A~ = A~} {B~ = B~} t~   ‚üßTm~ 
  = ∆õ‚â° ‚ü¶ Œì~ ‚üßCtx~ ‚ü¶ A~ ‚üßTy~ ‚ü¶ B~ ‚üßTy~ ‚ü¶ t~ ‚üßTm~
‚ü¶ ∆õ‚Åª¬π_ {Œì~ = Œì~} {A~ = A~} {B~ = B~} t~ ‚üßTm~ 
  = ∆õ‚Åª¬π‚â° ‚ü¶ Œì~ ‚üßCtx~ ‚ü¶ A~ ‚üßTy~ ‚ü¶ B~ ‚üßTy~ ‚ü¶ t~ ‚üßTm~
‚ü¶ œÄ‚ÇÇ Œ¥~        ‚üßTm~ = {!   !}
‚ü¶ TT Œì~        ‚üßTm~ = TT‚â° ‚ü¶ Œì~ ‚üßCtx~
‚ü¶ FF Œì~        ‚üßTm~ = FF‚â° ‚ü¶ Œì~ ‚üßCtx~
‚ü¶ t~ [ Œ¥~ ]    ‚üßTm~ = {!   !}
‚ü¶ œÄ‚ÇÇeq {b = true}  Œ¥ ‚üßTm~ with ‚ü¶ Œ¥ ‚üßTms
... | ‚ü¶Œ¥‚üß = funext·¥æ Œª œá ‚Üí funext·¥æ Œª œÅ ‚Üí ‚ü¶Œ¥‚üß .snd œÅ .snd .unbox
‚ü¶ œÄ‚ÇÇeq {b = false}  Œ¥ ‚üßTm~ with ‚ü¶ Œ¥ ‚üßTms
... | ‚ü¶Œ¥‚üß = funext·¥æ Œª œá ‚Üí funext·¥æ Œª œÅ ‚Üí ‚ü¶Œ¥‚üß .snd œÅ .snd .unbox
‚ü¶ TT[]               ‚üßTm~ = refl
‚ü¶ FF[]               ‚üßTm~ = refl
‚ü¶ ∆õ[]                ‚üßTm~ = refl
‚ü¶ [id]               ‚üßTm~ = refl
‚ü¶ [][]               ‚üßTm~ = refl
‚ü¶ Œ≤                  ‚üßTm~ = refl
‚ü¶ Œ∑                  ‚üßTm~ = refl
‚ü¶ œÄ‚ÇÇ,                ‚üßTm~ = refl
‚ü¶ œÄ‚ÇÇ‚®æ                ‚üßTm~ = refl
‚ü¶ callTT {Œ¥ = Œ¥} t~  ‚üßTm~ = call-TT‚â° {‚ü¶Œ¥‚üß = ‚ü¶ Œ¥ ‚üßTms} ‚ü¶ t~ ‚üßTm~
‚ü¶ callFF {Œ¥ = Œ¥} t~  ‚üßTm~ = call-FF‚â° {‚ü¶Œ¥‚üß = ‚ü¶ Œ¥ ‚üßTms} ‚ü¶ t~ ‚üßTm~

‚ü¶ rfl~              ‚üßTms~ = refl
‚ü¶ sym~ Œ¥~           ‚üßTms~ = sym[]·¥æ ‚ü¶ Œ¥~ ‚üßTms~
‚ü¶ Œ¥‚ÇÅ‚ÇÇ~ ‚àô~ Œ¥‚ÇÇ‚ÇÉ~      ‚üßTms~ = ‚ü¶ Œ¥‚ÇÅ‚ÇÇ~ ‚üßTms~ ‚àô[]·¥æ ‚ü¶ Œ¥‚ÇÇ‚ÇÉ~ ‚üßTms~
‚ü¶ coh               ‚üßTms~ = coh[]·¥æ
‚ü¶ Œµ                 ‚üßTms~ = {!   !}
‚ü¶ Œ¥~ , t~           ‚üßTms~ = {!   !}
‚ü¶ ,eq~ Œ¥~           ‚üßTms~ = {!   !}
‚ü¶ id                ‚üßTms~ = {!   !}
‚ü¶ Œ¥~ ‚®æ œÉ~           ‚üßTms~ = {!   !}
‚ü¶ œÄ‚ÇÅ A~ Œ¥~          ‚üßTms~ = {!   !}
‚ü¶ œÄ‚ÇÅeq t~ Œ¥~        ‚üßTms~ = {!   !}
‚ü¶ ŒµŒ∑                ‚üßTms~ = {!!}
‚ü¶ ,Œ∑                ‚üßTms~ = refl
‚ü¶ ,eqŒ∑ {b = true}   ‚üßTms~ = refl
‚ü¶ ,eqŒ∑ {b = false}  ‚üßTms~ = refl
‚ü¶ œÄ‚ÇÅ,               ‚üßTms~ = refl
‚ü¶ œÄ‚ÇÅeq, {b = false} ‚üßTms~ = refl
‚ü¶ œÄ‚ÇÅeq, {b = true}  ‚üßTms~ = refl
‚ü¶ œÄ‚ÇÅ‚®æ               ‚üßTms~ = refl
‚ü¶ œÄ‚ÇÅeq‚®æ             ‚üßTms~ = refl
‚ü¶ id‚®æ               ‚üßTms~ = refl
‚ü¶ ‚®æid               ‚üßTms~ = refl
‚ü¶ ‚®æ‚®æ                ‚üßTms~ = refl
‚ü¶ ,‚®æ                ‚üßTms~ = refl
‚ü¶ ,eq‚®æ {b = true}   ‚üßTms~ = refl
‚ü¶ ,eq‚®æ {b = false}  ‚üßTms~ = refl
‚ü¶ wkùíÆ               ‚üßTms~ = {!!}
‚ü¶ wk‚®æœÄ‚ÇÅ             ‚üßTms~ = {!!}
‚ü¶ wk‚®æœÄ‚ÇÅeq           ‚üßTms~ = {!!}
