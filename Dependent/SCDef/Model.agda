{-# OPTIONS --prop --rewriting --show-irrelevant 
            --no-require-unique-meta-solutions #-}

open import Utils
open import Utils.IdExtras

open import Dependent.SCDef.Syntax

-- Like "ModelOld.agda" but without asserting termination.
--
-- To achieve this, we use some trickery with foeqard references, with-clauses 
-- and specialising helpers, which makes unfortunately the definitions a bit 
-- clunkier in places.
module Dependent.SCDef.Model where

âŸ¦SigâŸ§ : Setâ‚
âŸ¦SigâŸ§ = Set


âŸ¦CtxâŸ§ : âŸ¦SigâŸ§ â†’ Setâ‚
âŸ¦CtxâŸ§ âŸ¦Î¨âŸ§ = âŸ¦Î¨âŸ§ â†’ Set

variable
  âŸ¦Î¨âŸ§ âŸ¦Î¦âŸ§ âŸ¦ÎâŸ§ : âŸ¦SigâŸ§ 

âŸ¦TyâŸ§ : âŸ¦CtxâŸ§ âŸ¦Î¨âŸ§ â†’ Setâ‚
âŸ¦TyâŸ§ âŸ¦Î“âŸ§ = âˆ€ Ï‡ â†’ âŸ¦Î“âŸ§ Ï‡ â†’ Set

âŸ¦TmâŸ§ : âˆ€ (âŸ¦Î“âŸ§ : âŸ¦CtxâŸ§ âŸ¦Î¨âŸ§) â†’ âŸ¦TyâŸ§ âŸ¦Î“âŸ§ â†’ Set
âŸ¦TmâŸ§ âŸ¦Î“âŸ§ âŸ¦AâŸ§ = âˆ€ Ï‡ Ï â†’ âŸ¦AâŸ§ Ï‡ Ï

âŸ¦WkâŸ§ : âŸ¦SigâŸ§ â†’ âŸ¦SigâŸ§ â†’ Set
âŸ¦WkâŸ§ âŸ¦Î¦âŸ§ âŸ¦Î¨âŸ§ = âŸ¦Î¦âŸ§ â†’ âŸ¦Î¨âŸ§

âŸ¦[]CâŸ§ : âŸ¦CtxâŸ§ âŸ¦Î¨âŸ§ â†’ âŸ¦WkâŸ§ âŸ¦Î¦âŸ§ âŸ¦Î¨âŸ§ â†’ âŸ¦CtxâŸ§ âŸ¦Î¦âŸ§
âŸ¦[]CâŸ§ âŸ¦Î“âŸ§ âŸ¦Î´âŸ§ = Î» Ï‡ â†’ âŸ¦Î“âŸ§ (âŸ¦Î´âŸ§ Ï‡)

âŸ¦TmsâŸ§ : âŸ¦CtxâŸ§ âŸ¦Î¦âŸ§ â†’ âŸ¦CtxâŸ§ âŸ¦Î¨âŸ§ â†’ Set
âŸ¦TmsâŸ§ {âŸ¦Î¦âŸ§ = âŸ¦Î¦âŸ§} {âŸ¦Î¨âŸ§ = âŸ¦Î¨âŸ§} âŸ¦Î”âŸ§ âŸ¦Î“âŸ§ 
  = Î£ (âŸ¦WkâŸ§ âŸ¦Î¦âŸ§ âŸ¦Î¨âŸ§) Î» âŸ¦Î´âŸ§ â†’ âˆ€ {Ï‡} â†’ âŸ¦Î”âŸ§ Ï‡ â†’ âŸ¦[]CâŸ§ âŸ¦Î“âŸ§ âŸ¦Î´âŸ§ Ï‡

variable
  âŸ¦Î¨â‚âŸ§ âŸ¦Î¨â‚‚âŸ§ âŸ¦Î¦â‚âŸ§ âŸ¦Î¦â‚‚âŸ§ : âŸ¦SigâŸ§
  âŸ¦Î“âŸ§ âŸ¦Î”âŸ§ âŸ¦Î˜âŸ§ âŸ¦Î“â‚âŸ§ âŸ¦Î“â‚‚âŸ§ âŸ¦Î”â‚âŸ§ âŸ¦Î”â‚‚âŸ§ âŸ¦Î˜â‚âŸ§ âŸ¦Î˜â‚‚âŸ§       : âŸ¦CtxâŸ§ âŸ¦Î¨âŸ§
  âŸ¦AâŸ§ âŸ¦BâŸ§ âŸ¦Aâ‚âŸ§ âŸ¦Aâ‚‚âŸ§ âŸ¦Bâ‚âŸ§ âŸ¦Bâ‚‚âŸ§       : âŸ¦TyâŸ§  âŸ¦Î“âŸ§ 
  âŸ¦tâŸ§ âŸ¦uâŸ§ âŸ¦vâŸ§ âŸ¦tâ‚âŸ§ âŸ¦tâ‚‚âŸ§ âŸ¦uâ‚âŸ§ âŸ¦uâ‚‚âŸ§ âŸ¦vâ‚âŸ§ âŸ¦vâ‚‚âŸ§ : âŸ¦TmâŸ§  âŸ¦Î“âŸ§ âŸ¦AâŸ§
  âŸ¦Î´âŸ§ âŸ¦Î´â‚âŸ§ âŸ¦Î´â‚‚âŸ§ âŸ¦Ïƒâ‚âŸ§ âŸ¦Ïƒâ‚‚âŸ§                     : âŸ¦TmsâŸ§ âŸ¦Î”âŸ§ âŸ¦Î“âŸ§
  âŸ¦Î³âŸ§ âŸ¦Î³â‚âŸ§ âŸ¦Î³â‚‚âŸ§                 : âŸ¦WkâŸ§ âŸ¦Î¦âŸ§ âŸ¦Î¨âŸ§

Ctxâ‰¡ : âŸ¦Î¨â‚âŸ§ â‰¡á´¾ âŸ¦Î¨â‚‚âŸ§ â†’ âŸ¦CtxâŸ§ âŸ¦Î¨â‚âŸ§ â‰¡á´¾ âŸ¦CtxâŸ§ âŸ¦Î¨â‚‚âŸ§
Ctxâ‰¡ refl = refl

Tyâ‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§ â†’ âŸ¦TyâŸ§ {âŸ¦Î¨âŸ§ = âŸ¦Î¨âŸ§} âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦TyâŸ§ âŸ¦Î“â‚‚âŸ§
Tyâ‰¡ refl = refl

Tmâ‰¡ : âˆ€ Î“â‰¡ â†’ âˆ€ (Aâ‰¡ : âŸ¦Aâ‚âŸ§ â‰¡[ Tyâ‰¡ {âŸ¦Î¨âŸ§ = âŸ¦Î¨âŸ§} Î“â‰¡ ]â‰¡á´¾ âŸ¦Aâ‚‚âŸ§) 
    â†’ âŸ¦TmâŸ§ âŸ¦Î“â‚âŸ§ âŸ¦Aâ‚âŸ§ â‰¡á´¾ âŸ¦TmâŸ§ âŸ¦Î“â‚‚âŸ§ âŸ¦Aâ‚‚âŸ§
Tmâ‰¡ refl refl = refl

Wkâ‰¡ : âŸ¦Î¦â‚âŸ§ â‰¡á´¾ âŸ¦Î¦â‚‚âŸ§ â†’ âŸ¦Î¨â‚âŸ§ â‰¡á´¾ âŸ¦Î¨â‚‚âŸ§ â†’ âŸ¦WkâŸ§ âŸ¦Î¦â‚âŸ§ âŸ¦Î¨â‚âŸ§ â‰¡á´¾ âŸ¦WkâŸ§ âŸ¦Î¦â‚‚âŸ§ âŸ¦Î¨â‚‚âŸ§
Wkâ‰¡ refl refl = refl

Tmsâ‰¡ : âŸ¦Î”â‚âŸ§ â‰¡á´¾ âŸ¦Î”â‚‚âŸ§ â†’ âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§ â†’ âŸ¦TmsâŸ§ âŸ¦Î”â‚âŸ§ âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦TmsâŸ§ âŸ¦Î”â‚‚âŸ§ âŸ¦Î“â‚‚âŸ§
Tmsâ‰¡ refl refl = refl

Tmsâ‰¡â€² : âˆ€ (Î¦â‰¡ : âŸ¦Î¦â‚âŸ§ â‰¡á´¾ âŸ¦Î¦â‚‚âŸ§) (Î¨â‰¡ : âŸ¦Î¨â‚âŸ§ â‰¡á´¾ âŸ¦Î¨â‚‚âŸ§) 
          (Î”â‰¡ : âŸ¦Î”â‚âŸ§ â‰¡[ Ctxâ‰¡ Î¦â‰¡ ]â‰¡á´¾ âŸ¦Î”â‚‚âŸ§) 
          (Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡[ Ctxâ‰¡ Î¨â‰¡ ]â‰¡á´¾ âŸ¦Î“â‚‚âŸ§)
      â†’ âŸ¦TmsâŸ§ âŸ¦Î”â‚âŸ§ âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦TmsâŸ§ âŸ¦Î”â‚‚âŸ§ âŸ¦Î“â‚‚âŸ§ 
Tmsâ‰¡â€² refl refl refl refl = refl

âŸ¦ğ”¹âŸ§ : âŸ¦TyâŸ§ âŸ¦Î“âŸ§
âŸ¦ğ”¹âŸ§ = Î» Ï‡ Ï â†’ Bool

âŸ¦â–·>eqâŸ§ : âˆ€ (âŸ¦Î“âŸ§ : âŸ¦CtxâŸ§ âŸ¦Î¨âŸ§) â†’ âŸ¦TmâŸ§ âŸ¦Î“âŸ§ âŸ¦ğ”¹âŸ§ â†’ Bool â†’ âŸ¦CtxâŸ§ âŸ¦Î¨âŸ§
âŸ¦â–·>eqâŸ§ âŸ¦Î“âŸ§ âŸ¦tâŸ§ b = Î» Ï‡ â†’ Î£ (âŸ¦Î“âŸ§ Ï‡) (Î» Ï â†’ Box (âŸ¦tâŸ§ Ï‡ Ï â‰¡á´¾ b))

âŸ¦idğ’®âŸ§ : âŸ¦WkâŸ§ âŸ¦Î¨âŸ§ âŸ¦Î¨âŸ§
âŸ¦idğ’®âŸ§ = Î» Ï‡ â†’ Ï‡

âŸ¦idâŸ§ : âŸ¦TmsâŸ§ âŸ¦Î“âŸ§ âŸ¦Î“âŸ§
âŸ¦idâŸ§ = âŸ¦idğ’®âŸ§ Î£, Î» Ï â†’ Ï

âŸ¦wkeqâŸ§ : âŸ¦TmsâŸ§ (âŸ¦â–·>eqâŸ§ âŸ¦Î“âŸ§ âŸ¦tâŸ§ b) âŸ¦Î“âŸ§
âŸ¦wkeqâŸ§ = âŸ¦idğ’®âŸ§ Î£, fst

âŸ¦Ï€â‚eqâŸ§ : âŸ¦TmsâŸ§ âŸ¦Î”âŸ§ (âŸ¦â–·>eqâŸ§ âŸ¦Î“âŸ§ âŸ¦tâŸ§ b) â†’ âŸ¦TmsâŸ§ âŸ¦Î”âŸ§ âŸ¦Î“âŸ§
âŸ¦Ï€â‚eqâŸ§ âŸ¦Î´âŸ§ = âŸ¦Î´âŸ§ .fst Î£, Î» Ï â†’ âŸ¦Î´âŸ§ .snd Ï .fst


âŸ¦[]TâŸ§ : âŸ¦TyâŸ§ âŸ¦Î“âŸ§ â†’ âŸ¦TmsâŸ§ âŸ¦Î”âŸ§ âŸ¦Î“âŸ§ â†’ âŸ¦TyâŸ§ âŸ¦Î”âŸ§
âŸ¦[]TâŸ§ âŸ¦AâŸ§ âŸ¦Î´âŸ§ Ï‡ Ï = âŸ¦AâŸ§ (âŸ¦Î´âŸ§ .fst Ï‡) (âŸ¦Î´âŸ§ .snd Ï)

âŸ¦â–·ğ’®âŸ§ : âˆ€ âŸ¦Î¨âŸ§ (âŸ¦Î“âŸ§ : âŸ¦CtxâŸ§ âŸ¦Î¨âŸ§) âŸ¦AâŸ§ âŸ¦tâŸ§
     â†’ âŸ¦TmâŸ§ (âŸ¦â–·>eqâŸ§ âŸ¦Î“âŸ§ âŸ¦tâŸ§ true)   (âŸ¦[]TâŸ§ âŸ¦AâŸ§ âŸ¦wkeqâŸ§) 
     â†’ âŸ¦TmâŸ§ (âŸ¦â–·>eqâŸ§ âŸ¦Î“âŸ§ âŸ¦tâŸ§ false)  (âŸ¦[]TâŸ§ âŸ¦AâŸ§ âŸ¦wkeqâŸ§) 
     â†’ âŸ¦SigâŸ§
âŸ¦â–·ğ’®âŸ§ âŸ¦Î¨âŸ§ âŸ¦Î“âŸ§ âŸ¦AâŸ§ âŸ¦tâŸ§ âŸ¦uâŸ§ âŸ¦vâŸ§ 
  = Î£ âŸ¦Î¨âŸ§ Î» Ï‡ â†’ 
    Î£ (âˆ€ Ï â†’ âŸ¦AâŸ§ Ï‡ Ï) Î» f â†’ 
      (âˆ€ Ï (t~ : âŸ¦tâŸ§ Ï‡ Ï â‰¡á´¾ true) 
    â†’ Box (f Ï â‰¡á´¾ âŸ¦uâŸ§ Ï‡ (Ï Î£, box t~)))
    Ã— (âˆ€ Ï (t~ : âŸ¦tâŸ§ Ï‡ Ï â‰¡á´¾ false)
    â†’ Box (f Ï â‰¡á´¾ âŸ¦vâŸ§ Ï‡ (Ï Î£, box t~)))

âŸ¦â¨¾ğ’®âŸ§ : âŸ¦WkâŸ§ âŸ¦Î¦âŸ§ âŸ¦Î¨âŸ§ â†’ âŸ¦WkâŸ§ âŸ¦ÎâŸ§ âŸ¦Î¦âŸ§ â†’ âŸ¦WkâŸ§ âŸ¦ÎâŸ§ âŸ¦Î¨âŸ§
âŸ¦â¨¾ğ’®âŸ§ âŸ¦Î´âŸ§ âŸ¦ÏƒâŸ§ = Î» Ï‡ â†’ âŸ¦Î´âŸ§ (âŸ¦ÏƒâŸ§ Ï‡)

âŸ¦âŒœâŒğ’®âŸ§ : âˆ€ (âŸ¦Î´âŸ§ : âŸ¦WkâŸ§ âŸ¦Î¦âŸ§ âŸ¦Î¨âŸ§) â†’ âŸ¦TmsâŸ§ (âŸ¦[]CâŸ§ âŸ¦Î“âŸ§ âŸ¦Î´âŸ§) âŸ¦Î“âŸ§
âŸ¦âŒœâŒğ’®âŸ§ âŸ¦Î´âŸ§ = âŸ¦Î´âŸ§ Î£, Î» Ï â†’ Ï

âŸ¦â¨¾âŸ§ : âŸ¦TmsâŸ§ âŸ¦Î”âŸ§ âŸ¦Î“âŸ§ â†’ âŸ¦TmsâŸ§ âŸ¦Î˜âŸ§ âŸ¦Î”âŸ§ â†’ âŸ¦TmsâŸ§ âŸ¦Î˜âŸ§ âŸ¦Î“âŸ§
âŸ¦â¨¾âŸ§ (âŸ¦Î´âŸ§ Î£, âŸ¦Î´âŸ§â€²) (âŸ¦ÏƒâŸ§ Î£, âŸ¦ÏƒâŸ§â€²) = âŸ¦â¨¾ğ’®âŸ§ âŸ¦Î´âŸ§ âŸ¦ÏƒâŸ§ Î£, Î» Ï â†’ âŸ¦Î´âŸ§â€² (âŸ¦ÏƒâŸ§â€² Ï)

âŸ¦ÎµâŸ§ : âŸ¦CtxâŸ§ âŸ¦Î¨âŸ§
âŸ¦ÎµâŸ§ = Î» _ â†’ âŠ¤

âŸ¦wkğ’®âŸ§ : âŸ¦â–·ğ’®âŸ§ âŸ¦Î¨âŸ§ âŸ¦Î“âŸ§ âŸ¦AâŸ§ âŸ¦tâŸ§ âŸ¦uâŸ§ âŸ¦vâŸ§ â†’ âŸ¦Î¨âŸ§
âŸ¦wkğ’®âŸ§ (Ï‡ Î£, f) = Ï‡

âŸ¦callâŸ§ : âŸ¦TmâŸ§ {âŸ¦Î¨âŸ§ = âŸ¦â–·ğ’®âŸ§ âŸ¦Î¨âŸ§ âŸ¦Î“âŸ§ âŸ¦AâŸ§ âŸ¦tâŸ§ âŸ¦uâŸ§ âŸ¦vâŸ§} 
              (âŸ¦[]CâŸ§ âŸ¦Î“âŸ§ âŸ¦wkğ’®âŸ§) (âŸ¦[]TâŸ§ âŸ¦AâŸ§ (âŸ¦âŒœâŒğ’®âŸ§ âŸ¦wkğ’®âŸ§))
âŸ¦callâŸ§ (Ï‡ Î£, f) Ï = f .fst Ï

variable
  Î¦â‰¡ Î¨â‰¡ : âŸ¦Î¨â‚âŸ§ â‰¡á´¾ âŸ¦Î¨â‚‚âŸ§
  Î“â‰¡ Î”â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§
  Aâ‰¡ : âŸ¦Aâ‚âŸ§ â‰¡[ Tyâ‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦Aâ‚‚âŸ§

âŸ¦â–·âŸ§ : âˆ€ (âŸ¦Î“âŸ§ : âŸ¦CtxâŸ§ âŸ¦Î¨âŸ§) â†’ âŸ¦TyâŸ§ âŸ¦Î“âŸ§ â†’ âŸ¦CtxâŸ§ âŸ¦Î¨âŸ§
âŸ¦â–·âŸ§ âŸ¦Î“âŸ§ âŸ¦AâŸ§ = Î» Ï‡ â†’ Î£ (âŸ¦Î“âŸ§ Ï‡) (Î» Ï â†’ âŸ¦AâŸ§ Ï‡ Ï) 

â–·â‰¡ : âˆ€ Î“â‰¡ â†’ âŸ¦Aâ‚âŸ§ â‰¡[ Tyâ‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦Aâ‚‚âŸ§ â†’ âŸ¦â–·âŸ§ âŸ¦Î“â‚âŸ§ âŸ¦Aâ‚âŸ§ â‰¡á´¾ âŸ¦â–·âŸ§ âŸ¦Î“â‚‚âŸ§ âŸ¦Aâ‚‚âŸ§ 
â–·â‰¡ refl refl = refl

âŸ¦Î âŸ§ : âˆ€ âŸ¦AâŸ§ â†’ âŸ¦TyâŸ§ (âŸ¦â–·âŸ§ âŸ¦Î“âŸ§ âŸ¦AâŸ§) â†’ âŸ¦TyâŸ§ âŸ¦Î“âŸ§
âŸ¦Î âŸ§ âŸ¦AâŸ§ âŸ¦BâŸ§ = Î» Ï‡ Ï â†’ âˆ€ uâ±½ â†’ âŸ¦BâŸ§ Ï‡ (Ï Î£, uâ±½)

ğ”¹â‰¡ : âˆ€ (Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§) â†’ âŸ¦ğ”¹âŸ§ â‰¡[ Tyâ‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦ğ”¹âŸ§
ğ”¹â‰¡ refl = refl

â–·>eqâ‰¡ : âˆ€ (Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§) â†’ âŸ¦tâ‚âŸ§ â‰¡[ Tmâ‰¡ Î“â‰¡ (ğ”¹â‰¡ Î“â‰¡) ]â‰¡á´¾ âŸ¦tâ‚‚âŸ§ 
      â†’ âŸ¦â–·>eqâŸ§ âŸ¦Î“â‚âŸ§ âŸ¦tâ‚âŸ§ b â‰¡á´¾ âŸ¦â–·>eqâŸ§ âŸ¦Î“â‚‚âŸ§ âŸ¦tâ‚‚âŸ§ b
â–·>eqâ‰¡ refl refl = refl

â¨¾â‰¡ : âˆ€ {âŸ¦Î´â‚âŸ§ : âŸ¦TmsâŸ§ âŸ¦Î”â‚âŸ§ âŸ¦Î“â‚âŸ§} {âŸ¦Î´â‚‚âŸ§ : âŸ¦TmsâŸ§ âŸ¦Î”â‚‚âŸ§ âŸ¦Î“â‚‚âŸ§} 
       {âŸ¦Ïƒâ‚âŸ§ : âŸ¦TmsâŸ§ âŸ¦Î˜â‚âŸ§ âŸ¦Î”â‚âŸ§} {âŸ¦Ïƒâ‚‚âŸ§ : âŸ¦TmsâŸ§ âŸ¦Î˜â‚‚âŸ§ âŸ¦Î”â‚‚âŸ§}
       (Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§) (Î”â‰¡ : âŸ¦Î”â‚âŸ§ â‰¡á´¾ âŸ¦Î”â‚‚âŸ§) (Î˜â‰¡ : âŸ¦Î˜â‚âŸ§ â‰¡á´¾ âŸ¦Î˜â‚‚âŸ§)
   â†’ âŸ¦Î´â‚âŸ§ â‰¡[ Tmsâ‰¡ Î”â‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦Î´â‚‚âŸ§ 
   â†’ âŸ¦Ïƒâ‚âŸ§ â‰¡[ Tmsâ‰¡ Î˜â‰¡ Î”â‰¡ ]â‰¡á´¾ âŸ¦Ïƒâ‚‚âŸ§
   â†’ âŸ¦â¨¾âŸ§ {âŸ¦Î“âŸ§ = âŸ¦Î“â‚âŸ§} âŸ¦Î´â‚âŸ§ âŸ¦Ïƒâ‚âŸ§ â‰¡[ Tmsâ‰¡ Î˜â‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦â¨¾âŸ§ {âŸ¦Î“âŸ§ = âŸ¦Î“â‚‚âŸ§} âŸ¦Î´â‚‚âŸ§ âŸ¦Ïƒâ‚‚âŸ§
â¨¾â‰¡ refl refl refl Î´â‰¡ Ïƒâ‰¡ = {!!}

Î â‰¡ : âˆ€ Î“â‰¡ Aâ‰¡ â†’ âŸ¦Bâ‚âŸ§ â‰¡[ Tyâ‰¡ (â–·â‰¡ Î“â‰¡ Aâ‰¡) ]â‰¡á´¾ âŸ¦Bâ‚‚âŸ§
     â†’ âŸ¦Î âŸ§ âŸ¦Aâ‚âŸ§ âŸ¦Bâ‚âŸ§ â‰¡[ Tyâ‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦Î âŸ§ âŸ¦Aâ‚‚âŸ§ âŸ¦Bâ‚‚âŸ§
Î â‰¡ refl refl refl = refl

âŸ¦TTâŸ§ : âŸ¦TmâŸ§ âŸ¦Î“âŸ§ âŸ¦ğ”¹âŸ§
âŸ¦TTâŸ§ _ _ = true

TTâ‰¡ : (Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§) â†’ âŸ¦TTâŸ§ â‰¡[ Tmâ‰¡ Î“â‰¡ (ğ”¹â‰¡ Î“â‰¡) ]â‰¡á´¾ âŸ¦TTâŸ§ 
TTâ‰¡ refl = refl

âŸ¦FFâŸ§ : âŸ¦TmâŸ§ âŸ¦Î“âŸ§ âŸ¦ğ”¹âŸ§
âŸ¦FFâŸ§ _ _ = false

FFâ‰¡ : (Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§) â†’ âŸ¦FFâŸ§ â‰¡[ Tmâ‰¡ Î“â‰¡ (ğ”¹â‰¡ Î“â‰¡) ]â‰¡á´¾ âŸ¦FFâŸ§ 
FFâ‰¡ refl = refl

âŸ¦Æ›âŸ§ : âŸ¦TmâŸ§ (âŸ¦â–·âŸ§ âŸ¦Î“âŸ§ âŸ¦AâŸ§) âŸ¦BâŸ§ â†’ âŸ¦TmâŸ§ âŸ¦Î“âŸ§ (âŸ¦Î âŸ§ âŸ¦AâŸ§ âŸ¦BâŸ§)
âŸ¦Æ›âŸ§ âŸ¦tâŸ§ Ï‡ Ï uâ±½ = âŸ¦tâŸ§ Ï‡ (Ï Î£, uâ±½)

Æ›â‰¡ : âˆ€ (Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§) 
       (Aâ‰¡ : âŸ¦Aâ‚âŸ§ â‰¡[ Tyâ‰¡ {âŸ¦Î¨âŸ§ = âŸ¦Î¨âŸ§} Î“â‰¡ ]â‰¡á´¾ âŸ¦Aâ‚‚âŸ§)
       (Bâ‰¡ : âŸ¦Bâ‚âŸ§ â‰¡[ Tyâ‰¡ (â–·â‰¡ Î“â‰¡ Aâ‰¡) ]â‰¡á´¾ âŸ¦Bâ‚‚âŸ§)
   â†’ âŸ¦tâ‚âŸ§ â‰¡[ Tmâ‰¡ (â–·â‰¡ Î“â‰¡ Aâ‰¡) Bâ‰¡ ]â‰¡á´¾ âŸ¦tâ‚‚âŸ§
   â†’ âŸ¦Æ›âŸ§ âŸ¦tâ‚âŸ§ â‰¡[ Tmâ‰¡ Î“â‰¡ (Î â‰¡ Î“â‰¡ Aâ‰¡ Bâ‰¡) ]â‰¡á´¾ âŸ¦Æ›âŸ§ âŸ¦tâ‚‚âŸ§
Æ›â‰¡ refl refl refl refl = refl

âŸ¦Æ›â»Â¹âŸ§ : âŸ¦TmâŸ§ âŸ¦Î“âŸ§ (âŸ¦Î âŸ§ âŸ¦AâŸ§ âŸ¦BâŸ§) â†’ âŸ¦TmâŸ§ (âŸ¦â–·âŸ§ âŸ¦Î“âŸ§ âŸ¦AâŸ§) âŸ¦BâŸ§
âŸ¦Æ›â»Â¹âŸ§ âŸ¦tâŸ§ Ï‡ (Ï Î£, uâ±½) = âŸ¦tâŸ§ Ï‡ Ï uâ±½

Æ›â»Â¹â‰¡ : âˆ€ {âŸ¦Bâ‚‚âŸ§ âŸ¦tâ‚‚âŸ§} (Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§) 
         (Aâ‰¡ : âŸ¦Aâ‚âŸ§ â‰¡[ Tyâ‰¡ {âŸ¦Î¨âŸ§ = âŸ¦Î¨âŸ§} Î“â‰¡ ]â‰¡á´¾ âŸ¦Aâ‚‚âŸ§)
         (Bâ‰¡ : âŸ¦Bâ‚âŸ§ â‰¡[ Tyâ‰¡ (â–·â‰¡ Î“â‰¡ Aâ‰¡) ]â‰¡á´¾ âŸ¦Bâ‚‚âŸ§)
   â†’ âŸ¦tâ‚âŸ§ â‰¡[ Tmâ‰¡ Î“â‰¡ (Î â‰¡ Î“â‰¡ Aâ‰¡ Bâ‰¡) ]â‰¡á´¾ âŸ¦tâ‚‚âŸ§
   â†’ âŸ¦Æ›â»Â¹âŸ§ âŸ¦tâ‚âŸ§ â‰¡[ Tmâ‰¡ (â–·â‰¡ Î“â‰¡ Aâ‰¡) Bâ‰¡ ]â‰¡á´¾ âŸ¦Æ›â»Â¹âŸ§ âŸ¦tâ‚‚âŸ§
Æ›â»Â¹â‰¡ refl refl refl refl = refl

[]Tâ‰¡ : âˆ€ {âŸ¦Aâ‚âŸ§ : âŸ¦TyâŸ§ âŸ¦Î“â‚âŸ§} {âŸ¦Aâ‚‚âŸ§ : âŸ¦TyâŸ§ âŸ¦Î“â‚‚âŸ§}
         {âŸ¦Î´â‚âŸ§ : âŸ¦TmsâŸ§ âŸ¦Î”â‚âŸ§ âŸ¦Î“â‚âŸ§} {âŸ¦Î´â‚‚âŸ§ : âŸ¦TmsâŸ§ âŸ¦Î”â‚‚âŸ§ âŸ¦Î“â‚‚âŸ§}
         Î“â‰¡ Î”â‰¡ â†’ âŸ¦Aâ‚âŸ§ â‰¡[ Tyâ‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦Aâ‚‚âŸ§ â†’ âŸ¦Î´â‚âŸ§ â‰¡[ Tmsâ‰¡ Î”â‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦Î´â‚‚âŸ§
     â†’ âŸ¦[]TâŸ§ âŸ¦Aâ‚âŸ§ âŸ¦Î´â‚âŸ§ â‰¡[ Tyâ‰¡ Î”â‰¡ ]â‰¡á´¾ âŸ¦[]TâŸ§ âŸ¦Aâ‚‚âŸ§ âŸ¦Î´â‚‚âŸ§
[]Tâ‰¡ refl refl refl Î´â‰¡ = {!!}

wkeqâ‰¡ : âˆ€ (Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§) (tâ‰¡ : âŸ¦tâ‚âŸ§ â‰¡[ Tmâ‰¡ {âŸ¦Î¨âŸ§ = âŸ¦Î¨âŸ§} Î“â‰¡ (ğ”¹â‰¡ Î“â‰¡) ]â‰¡á´¾ âŸ¦tâ‚‚âŸ§) 
      â†’ âŸ¦wkeqâŸ§ â‰¡[ Tmsâ‰¡  (â–·>eqâ‰¡ {b = b} Î“â‰¡ tâ‰¡) Î“â‰¡ ]â‰¡á´¾ âŸ¦wkeqâŸ§
wkeqâ‰¡ refl refl = refl

âŸ¦ifâŸ§ : âˆ€ âŸ¦tâŸ§ 
     â†’ âŸ¦TmâŸ§ (âŸ¦â–·>eqâŸ§ âŸ¦Î“âŸ§ âŸ¦tâŸ§ true)  (âŸ¦[]TâŸ§ âŸ¦AâŸ§ âŸ¦wkeqâŸ§)
     â†’ âŸ¦TmâŸ§ (âŸ¦â–·>eqâŸ§ âŸ¦Î“âŸ§ âŸ¦tâŸ§ false) (âŸ¦[]TâŸ§ âŸ¦AâŸ§ âŸ¦wkeqâŸ§)
     â†’ âŸ¦TmâŸ§ âŸ¦Î“âŸ§ âŸ¦AâŸ§
âŸ¦ifâŸ§ âŸ¦tâŸ§ âŸ¦uâŸ§ âŸ¦vâŸ§ 
  = Î» Ï‡ Ï â†’ Bool-splitá´¾ (âŸ¦tâŸ§ Ï‡ Ï) 
                        (Î» t~ â†’ âŸ¦uâŸ§ Ï‡ (Ï Î£, box t~)) 
                        (Î» t~ â†’ âŸ¦vâŸ§ Ï‡ (Ï Î£, box t~)) 

ifâ‰¡ : âˆ€ (Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§) (Aâ‰¡ : âŸ¦Aâ‚âŸ§ â‰¡[ Tyâ‰¡ {âŸ¦Î¨âŸ§ = âŸ¦Î¨âŸ§} Î“â‰¡ ]â‰¡á´¾ âŸ¦Aâ‚‚âŸ§) 
        (tâ‰¡ : âŸ¦tâ‚âŸ§ â‰¡[ Tmâ‰¡ Î“â‰¡ (ğ”¹â‰¡ Î“â‰¡) ]â‰¡á´¾ âŸ¦tâ‚‚âŸ§)
    â†’ âŸ¦uâ‚âŸ§ â‰¡[ Tmâ‰¡ (â–·>eqâ‰¡ Î“â‰¡ tâ‰¡) ([]Tâ‰¡ Î“â‰¡ (â–·>eqâ‰¡ Î“â‰¡ tâ‰¡) Aâ‰¡ (wkeqâ‰¡ Î“â‰¡ tâ‰¡)) 
           ]â‰¡á´¾ âŸ¦uâ‚‚âŸ§
    â†’ âŸ¦vâ‚âŸ§ â‰¡[ Tmâ‰¡ (â–·>eqâ‰¡ Î“â‰¡ tâ‰¡) ([]Tâ‰¡ Î“â‰¡ (â–·>eqâ‰¡ Î“â‰¡ tâ‰¡) Aâ‰¡ (wkeqâ‰¡ Î“â‰¡ tâ‰¡)) 
           ]â‰¡á´¾ âŸ¦vâ‚‚âŸ§
    â†’ âŸ¦ifâŸ§ âŸ¦tâ‚âŸ§ âŸ¦uâ‚âŸ§ âŸ¦vâ‚âŸ§ â‰¡[ Tmâ‰¡ Î“â‰¡ Aâ‰¡ ]â‰¡á´¾ âŸ¦ifâŸ§ âŸ¦tâ‚‚âŸ§ âŸ¦uâ‚‚âŸ§ âŸ¦vâ‚‚âŸ§
ifâ‰¡ refl refl refl refl refl = refl

âŸ¦[]tâŸ§ : âŸ¦TmâŸ§ âŸ¦Î“âŸ§ âŸ¦AâŸ§ â†’ âˆ€ (âŸ¦Î´âŸ§ : âŸ¦TmsâŸ§ âŸ¦Î”âŸ§ âŸ¦Î“âŸ§) â†’ âŸ¦TmâŸ§ âŸ¦Î”âŸ§ (âŸ¦[]TâŸ§ âŸ¦AâŸ§ âŸ¦Î´âŸ§)
âŸ¦[]tâŸ§ âŸ¦tâŸ§ (âŸ¦Î´âŸ§ Î£, âŸ¦Î´âŸ§â€²) = Î» Ï‡ Ï â†’ âŸ¦tâŸ§ (âŸ¦Î´âŸ§ Ï‡) (âŸ¦Î´âŸ§â€² Ï)

-- TODO: Generalise further?
[]Câ‰¡ : âˆ€ (Î¦â‰¡ : âŸ¦Î¦â‚âŸ§ â‰¡á´¾ âŸ¦Î¦â‚‚âŸ§)
     â†’ âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§ â†’ âŸ¦Î³â‚âŸ§ â‰¡[ Wkâ‰¡ Î¦â‰¡ refl ]â‰¡á´¾ âŸ¦Î³â‚‚âŸ§
     â†’ âŸ¦[]CâŸ§ âŸ¦Î“â‚âŸ§ âŸ¦Î³â‚âŸ§ â‰¡[ Ctxâ‰¡ Î¦â‰¡ ]â‰¡á´¾ âŸ¦[]CâŸ§ âŸ¦Î“â‚‚âŸ§ âŸ¦Î³â‚‚âŸ§
[]Câ‰¡ refl refl refl = refl

âŒœâŒğ’®â‰¡ : âˆ€ {âŸ¦Î³â‚âŸ§ : âŸ¦WkâŸ§ âŸ¦Î¦â‚âŸ§ âŸ¦Î¨â‚âŸ§} 
         (Î¦â‰¡ : âŸ¦Î¦â‚âŸ§ â‰¡á´¾ âŸ¦Î¦â‚‚âŸ§) (Î¨ : âŸ¦Î¨â‚âŸ§ â‰¡á´¾ âŸ¦Î¨â‚‚âŸ§) 
         (Î³â‰¡ : âŸ¦Î³â‚âŸ§ â‰¡[ Wkâ‰¡ Î¦â‰¡ Î¨â‰¡ ]â‰¡á´¾ âŸ¦Î³â‚‚âŸ§) 
     â†’ âŸ¦âŒœâŒğ’®âŸ§ {âŸ¦Î“âŸ§ = âŸ¦Î“âŸ§} âŸ¦Î³â‚âŸ§ 
     â‰¡[ Tmsâ‰¡â€² {âŸ¦Î“â‚âŸ§ = âŸ¦Î“âŸ§} Î¦â‰¡ Î¨â‰¡ ([]Câ‰¡ {âŸ¦Î“â‚âŸ§ = âŸ¦Î“âŸ§} Î¦â‰¡ refl Î³â‰¡) refl 
     ]â‰¡á´¾ âŸ¦âŒœâŒğ’®âŸ§ {âŸ¦Î“âŸ§ = âŸ¦Î“âŸ§} âŸ¦Î³â‚‚âŸ§
âŒœâŒğ’®â‰¡  refl refl refl = refl

Tyâ‰¡-inst : âˆ€ {Ï‡ : âŸ¦Î¨âŸ§} {Ï : âŸ¦Î“âŸ§ Ï‡} â†’ âŸ¦Aâ‚âŸ§ â‰¡á´¾ âŸ¦Aâ‚‚âŸ§ â†’ âŸ¦Aâ‚âŸ§ Ï‡ Ï â‰¡á´¾ âŸ¦Aâ‚‚âŸ§ Ï‡ Ï
Tyâ‰¡-inst refl = refl

Tmâ‰¡-inst : âˆ€ {Ï‡ : âŸ¦Î¨âŸ§} {Ï : âŸ¦Î“âŸ§ Ï‡} â†’ âŸ¦tâ‚âŸ§ â‰¡á´¾ âŸ¦tâ‚‚âŸ§ â†’ âŸ¦tâ‚âŸ§ Ï‡ Ï â‰¡á´¾ âŸ¦tâ‚‚âŸ§ Ï‡ Ï
Tmâ‰¡-inst refl = refl

Tm[]â‰¡-inst : âˆ€ {Ï‡ : âŸ¦Î¨âŸ§} {Ï : âŸ¦Î“âŸ§ Ï‡} (Aâ‰¡ : âŸ¦Aâ‚âŸ§ â‰¡á´¾ âŸ¦Aâ‚‚âŸ§) 
           â†’ âŸ¦tâ‚âŸ§ â‰¡[ Tmâ‰¡ refl Aâ‰¡ ]â‰¡á´¾ âŸ¦tâ‚‚âŸ§ 
           â†’ âŸ¦tâ‚âŸ§ Ï‡ Ï â‰¡[ Tyâ‰¡-inst Aâ‰¡ ]â‰¡á´¾ âŸ¦tâ‚‚âŸ§ Ï‡ Ï
Tm[]â‰¡-inst refl refl = refl

âŸ¦,eqâŸ§ : âˆ€ (âŸ¦Î´âŸ§ : âŸ¦TmsâŸ§ âŸ¦Î”âŸ§ âŸ¦Î“âŸ§) â†’ âŸ¦[]tâŸ§ âŸ¦tâŸ§ âŸ¦Î´âŸ§ â‰¡á´¾ (Î» Ï‡ Ï â†’ b)
      â†’ âŸ¦TmsâŸ§ âŸ¦Î”âŸ§ (âŸ¦â–·>eqâŸ§ âŸ¦Î“âŸ§ âŸ¦tâŸ§ b)
âŸ¦,eqâŸ§ (âŸ¦Î´âŸ§ Î£, âŸ¦Î´âŸ§â€²) tâ‰¡ = âŸ¦Î´âŸ§ Î£, Î» Ï â†’ âŸ¦Î´âŸ§â€² Ï Î£, box (Tmâ‰¡-inst tâ‰¡)

âŸ¦_âŸ§Sig : Sig â†’ âŸ¦SigâŸ§
âŸ¦_âŸ§Ctx : Ctx Î¨ â†’ âŸ¦CtxâŸ§ âŸ¦ Î¨ âŸ§Sig
âŸ¦_âŸ§Ty  : Ty Î“ â†’ âŸ¦TyâŸ§ âŸ¦ Î“ âŸ§Ctx
âŸ¦_âŸ§Tm  : Tm Î“ A â†’ âŸ¦TmâŸ§ âŸ¦ Î“ âŸ§Ctx âŸ¦ A âŸ§Ty
âŸ¦_âŸ§Wk  : Wk Î¦ Î¨ â†’ âŸ¦WkâŸ§ âŸ¦ Î¦ âŸ§Sig âŸ¦ Î¨ âŸ§Sig 
âŸ¦_âŸ§Tms : Tms Î” Î“ â†’ âŸ¦TmsâŸ§ âŸ¦ Î” âŸ§Ctx âŸ¦ Î“ âŸ§Ctx

variable
  Ï‡ Ï‡â‚ Ï‡â‚‚ : âŸ¦Î¨âŸ§
  Ï Ïâ‚ Ïâ‚‚ : âŸ¦Î“âŸ§ Ï‡

âŸ¦_âŸ§Ctx~ : Ctx~ Î“â‚ Î“â‚‚ â†’ âŸ¦ Î“â‚ âŸ§Ctx â‰¡á´¾ âŸ¦ Î“â‚‚ âŸ§Ctx
âŸ¦_âŸ§Ty~  : Ty~ Î“~ Aâ‚ Aâ‚‚ â†’ âŸ¦ Aâ‚ âŸ§Ty â‰¡[ congá´¾ âŸ¦TyâŸ§ âŸ¦ Î“~ âŸ§Ctx~ ]â‰¡á´¾ âŸ¦ Aâ‚‚ âŸ§Ty
âŸ¦_âŸ§Tm~  : Tm~ Î“~ A~ tâ‚ tâ‚‚ 
        â†’ âŸ¦ tâ‚ âŸ§Tm â‰¡[ Tmâ‰¡ âŸ¦ Î“~ âŸ§Ctx~ âŸ¦ A~ âŸ§Ty~ ]â‰¡á´¾ âŸ¦ tâ‚‚ âŸ§Tm
âŸ¦âŸ§Wk~   : âŸ¦ Î¾â‚ âŸ§Wk â‰¡á´¾ âŸ¦ Î¾â‚‚ âŸ§Wk
âŸ¦_âŸ§Tms~ : Tms~ Î”~ Î“~ Î´â‚ Î´â‚‚ 
        â†’ âŸ¦ Î´â‚ âŸ§Tms â‰¡[ Tmsâ‰¡ âŸ¦ Î”~ âŸ§Ctx~ âŸ¦ Î“~ âŸ§Ctx~ ]â‰¡á´¾ âŸ¦ Î´â‚‚ âŸ§Tms

âŸ¦ğ”¹âŸ§â€² : âŸ¦ ğ”¹ {Î“ = Î“} âŸ§Ty â‰¡á´¾ Î» Ï‡ Ï â†’ Bool 

âŸ¦â–·>eqâŸ§â€² : âˆ€ (Î“ : Ctx Î¨) â†’ âŸ¦TmâŸ§ âŸ¦ Î“ âŸ§Ctx âŸ¦ ğ”¹ âŸ§Ty â†’ Bool â†’ âŸ¦CtxâŸ§ âŸ¦ Î¨ âŸ§Sig

âŸ¦ â€¢           âŸ§Ctx = Î» Ï‡ â†’ âŠ¤
âŸ¦ Î“ â–· A       âŸ§Ctx = Î» Ï‡ â†’ Î£ (âŸ¦ Î“ âŸ§Ctx Ï‡) (Î» Ï â†’ âŸ¦ A âŸ§Ty Ï‡ Ï)
âŸ¦ Î“ â–· t >eq b âŸ§Ctx = âŸ¦â–·>eqâŸ§â€² Î“ âŸ¦ t âŸ§Tm b
âŸ¦ Î“ [ Î´ ]     âŸ§Ctx = Î» Ï‡ â†’ âŸ¦ Î“ âŸ§Ctx (âŸ¦ Î´ âŸ§Wk Ï‡)


âŸ¦ coe~ Î“~ A âŸ§Ty = coeá´¾ (Tyâ‰¡ âŸ¦ Î“~ âŸ§Ctx~) âŸ¦ A âŸ§Ty
âŸ¦ ğ”¹         âŸ§Ty = âŸ¦ğ”¹âŸ§
âŸ¦ Î  A B     âŸ§Ty = Î» Ï‡ Ï â†’ âˆ€ tâ±½ â†’ âŸ¦ B âŸ§Ty Ï‡ (Ï Î£, tâ±½)
âŸ¦ A [ Î´ ]   âŸ§Ty = âŸ¦[]TâŸ§ âŸ¦ A âŸ§Ty âŸ¦ Î´ âŸ§Tms
âŸ¦ if t A B  âŸ§Ty = Î» Ï‡ Ï â†’ Bool-rec (âŸ¦ t âŸ§Tm Ï‡ Ï) (âŸ¦ A âŸ§Ty Ï‡ Ï) (âŸ¦ B âŸ§Ty Ï‡ Ï)

âŸ¦â–·>eqâŸ§â€² Î“ âŸ¦tâŸ§ b = âŸ¦â–·>eqâŸ§ âŸ¦ Î“ âŸ§Ctx âŸ¦tâŸ§ b


âŸ¦TTâŸ§â€² : âŸ¦ TT {Î“ = Î“} âŸ§Tm â‰¡á´¾ Î» Ï‡ Ï â†’ true
âŸ¦FFâŸ§â€² : âŸ¦ FF {Î“ = Î“} âŸ§Tm â‰¡á´¾ Î» Ï‡ Ï â†’ false
âŸ¦[]âŸ§â€² : âˆ€ {t : Tm Î“ A} {Î´ : Tms {Î¦ = Î¦} {Î¨ = Î¨} Î” Î“} 
      â†’ âŸ¦ t [ Î´ ] âŸ§Tm 
      â‰¡á´¾ Î» Ï‡ Ï â†’ âŸ¦ t âŸ§Tm (âŸ¦ Î´ âŸ§Tms .fst Ï‡) (âŸ¦ Î´ âŸ§Tms .snd Ï)

âŸ¦wkğ’®âŸ§â€² : âŸ¦ Î¨ â–· Î“ â‡’ A if t then u else v âŸ§Sig â†’ âŸ¦ Î¨ âŸ§Sig

âŸ¦ id    âŸ§Wk = âŸ¦idğ’®âŸ§
âŸ¦ Î´ â¨¾ Ïƒ âŸ§Wk = Î» Ï‡ â†’ âŸ¦ Î´ âŸ§Wk (âŸ¦ Ïƒ âŸ§Wk Ï‡)
âŸ¦ wkğ’®   âŸ§Wk = âŸ¦wkğ’®âŸ§â€²

âŸ¦,eqâŸ§â€² : âˆ€ (Î´ : Tms {Î¦ = Î¦} {Î¨ = Î¨} Î” Î“) {t : Tm Î“ ğ”¹} 
           Ï‡ (Ï : âŸ¦ Î” âŸ§Ctx Ï‡) 
       â†’ âŸ¦[]tâŸ§ âŸ¦ t âŸ§Tm âŸ¦ Î´ âŸ§Tms Ï‡ Ï â‰¡á´¾ b
       â†’ âŸ¦[]CâŸ§ (âŸ¦â–·>eqâŸ§ âŸ¦ Î“ âŸ§Ctx âŸ¦ t âŸ§Tm b) (âŸ¦ Î´ âŸ§Tms .fst) Ï‡

âŸ¦ coe~ Î”~ Î“~ Î´ âŸ§Tms = coeá´¾ (Tmsâ‰¡ âŸ¦ Î”~ âŸ§Ctx~ âŸ¦ Î“~ âŸ§Ctx~) âŸ¦ Î´ âŸ§Tms
âŸ¦ Ï€â‚ Î´         âŸ§Tms = âŸ¦ Î´ âŸ§Tms .fst Î£, Î» Ï â†’ âŸ¦ Î´ âŸ§Tms .snd Ï .fst
âŸ¦ id           âŸ§Tms = âŸ¦idâŸ§
âŸ¦ Ï€â‚eq {t = t} Î´ âŸ§Tms = âŸ¦Ï€â‚eqâŸ§ {âŸ¦tâŸ§ = âŸ¦ t âŸ§Tm} âŸ¦ Î´ âŸ§Tms            
âŸ¦ Îµ            âŸ§Tms = âŸ¦idğ’®âŸ§ Î£, Î» Ï â†’ tt
âŸ¦ Î´ , t âŸ§Tms        = âŸ¦ Î´ âŸ§Tms .fst Î£, Î» Ï â†’ âŸ¦ Î´ âŸ§Tms .snd Ï Î£, âŸ¦ t âŸ§Tm _ Ï
âŸ¦ ,eqâ„± {b = true} Î´ {u = u} refl t~ âŸ§Tms 
  with symá´¾ (âŸ¦[]âŸ§â€² {Î´ = Î´}) âˆ™á´¾ âŸ¦ t~ âŸ§Tm~ âˆ™á´¾ âŸ¦TTâŸ§â€²
... | tâ‰¡ = âŸ¦ Î´ âŸ§Tms .fst Î£, Î» Ï â†’ âŸ¦,eqâŸ§â€² Î´ _ Ï (Tmâ‰¡-inst tâ‰¡)
âŸ¦ ,eqâ„± {b = false} Î´ {u = u} refl t~ âŸ§Tms 
  with symá´¾ (âŸ¦[]âŸ§â€² {Î´ = Î´}) âˆ™á´¾ âŸ¦ t~ âŸ§Tm~ âˆ™á´¾ âŸ¦FFâŸ§â€²
... | tâ‰¡ = âŸ¦ Î´ âŸ§Tms .fst Î£, Î» Ï â†’ âŸ¦,eqâŸ§â€² Î´ _ Ï (Tmâ‰¡-inst tâ‰¡)
âŸ¦ Î´ â¨¾ Ïƒ âŸ§Tms = _ Î£, Î» Ï â†’ âŸ¦ Î´ âŸ§Tms .snd (âŸ¦ Ïƒ âŸ§Tms .snd Ï)
âŸ¦ wkğ’® âŸ§Tms = âŸ¦wkğ’®âŸ§â€² Î£, Î» Ï â†’ Ï

âŸ¦ â€¢                               âŸ§Sig = âŠ¤
âŸ¦ Î¨ â–·  Î“ â‡’ A if t then u else v   âŸ§Sig
  = âŸ¦â–·ğ’®âŸ§ âŸ¦ Î¨ âŸ§Sig âŸ¦ Î“ âŸ§Ctx âŸ¦ A âŸ§Ty âŸ¦ t âŸ§Tm âŸ¦ u âŸ§Tm âŸ¦ v âŸ§Tm

âŸ¦wkğ’®âŸ§â€² (Ï‡ Î£, f) = Ï‡

âŸ¦ coe~ Î“~ A~ t âŸ§Tm = coeá´¾ (Tmâ‰¡ âŸ¦ Î“~ âŸ§Ctx~ âŸ¦ A~ âŸ§Ty~) âŸ¦ t âŸ§Tm

âŸ¦ Æ› t     âŸ§Tm = Î» Ï‡ Ï uâ±½ â†’ âŸ¦ t âŸ§Tm Ï‡ (Ï Î£, uâ±½)
âŸ¦ Æ›â»Â¹ t   âŸ§Tm = Î» Ï‡ (Ï Î£, uâ±½)   â†’ âŸ¦ t âŸ§Tm Ï‡ Ï uâ±½
âŸ¦ TT      âŸ§Tm = Î» Ï‡ Ï          â†’ true
âŸ¦ FF      âŸ§Tm = Î» Ï‡ Ï          â†’ false
âŸ¦ t [ Î´ ] âŸ§Tm = âŸ¦[]tâŸ§ âŸ¦ t âŸ§Tm âŸ¦ Î´ âŸ§Tms
âŸ¦ Ï€â‚‚ Î´  âŸ§Tm = Î» Ï‡ Ï â†’ âŸ¦ Î´ âŸ§Tms .snd Ï .snd
âŸ¦ call {A = A} âŸ§Tm (Ï‡ Î£, f) Ï 
  = f .fst Ï

âŸ¦,eqâŸ§â€² {b = b} Î´ Ï‡ Ï tâ‰¡ = âŸ¦ Î´ âŸ§Tms .snd Ï Î£, box tâ‰¡

âŸ¦TTâŸ§â€² = refl
âŸ¦FFâŸ§â€² = refl
âŸ¦[]âŸ§â€² = refl

âŸ¦ğ”¹âŸ§â€² = refl

âŸ¦âŒœâŒğ’®âŸ§â‰¡ : âˆ€ {âŒœÎ¾âŒ} â†’ âŒœÎ¾âŒ â‰¡á´¾ âŒœ_âŒğ’® {Î“ = Î“} Î¾
       â†’ âŸ¦ âŒœÎ¾âŒ âŸ§Tms â‰¡á´¾ âŸ¦âŒœâŒğ’®âŸ§ {âŸ¦Î“âŸ§ = âŸ¦ Î“ âŸ§Ctx} âŸ¦ Î¾ âŸ§Wk
âŸ¦âŒœâŒğ’®âŸ§â‰¡ {Î¾ = id} refl = refl
âŸ¦âŒœâŒğ’®âŸ§â‰¡ {Î“ = Î“} {Î¾ = Ï† â¨¾ Ïˆ} refl
  = â¨¾â‰¡ (refl {x = âŸ¦ Î“ âŸ§Ctx}) refl refl 
       (âŸ¦âŒœâŒğ’®âŸ§â‰¡ {Î¾ = Ï†} refl) (âŸ¦âŒœâŒğ’®âŸ§â‰¡ {Î¾ = Ïˆ} refl)
âŸ¦âŒœâŒğ’®âŸ§â‰¡ {Î¾ = wkğ’®} refl = refl

-- I'm not immediately sure how to prove this, but it is obviously true
-- Perhaps this would be easier if we enforced that |Wk| in the model was
-- unique (rather than an arbitrary function between signatures, we could use a
-- first-order representation) but I think losing functor laws would be 
-- kinda miserable
wk-uniq : âˆ€ {Î¾â‚ Î¾â‚‚ : Wk Ï‡ Î¨} â†’ âŸ¦ Î¾â‚ âŸ§Wk â‰¡á´¾ âŸ¦ Î¾â‚‚ âŸ§Wk
wk-uniq = {!!}
 
âŸ¦ rfl~         âŸ§Ctx~ = refl
âŸ¦ sym~ Î“~      âŸ§Ctx~ = symá´¾ âŸ¦ Î“~ âŸ§Ctx~
âŸ¦ Î“â‚â‚‚~ âˆ™~ Î“â‚‚â‚ƒ~ âŸ§Ctx~ = âŸ¦ Î“â‚â‚‚~ âŸ§Ctx~ âˆ™á´¾ âŸ¦ Î“â‚‚â‚ƒ~ âŸ§Ctx~
âŸ¦ Î“~ â–· A~      âŸ§Ctx~ = â–·â‰¡ âŸ¦ Î“~ âŸ§Ctx~ âŸ¦ A~ âŸ§Ty~
âŸ¦ Î“~ â–· t~ >eq  âŸ§Ctx~ = â–·>eqâ‰¡ âŸ¦ Î“~ âŸ§Ctx~ âŸ¦ t~ âŸ§Tm~
âŸ¦ _[] {Î¾â‚ = Î¾â‚} {Î¾â‚‚ = Î¾â‚‚} Î“~ âŸ§Ctx~ 
  = []Câ‰¡ refl âŸ¦ Î“~ âŸ§Ctx~ (wk-uniq {Î¾â‚ = Î¾â‚} {Î¾â‚‚ = Î¾â‚‚})
âŸ¦ â€¢[] âŸ§Ctx~ = refl
âŸ¦ â–·[]â„± {Î¾ = Î¾} {A = A} refl âŸ§Ctx~ 
  = â–·â‰¡ refl ([]Tâ‰¡ refl refl (refl {x = âŸ¦ A âŸ§Ty}) (symá´¾ (âŸ¦âŒœâŒğ’®âŸ§â‰¡ {Î¾ = Î¾} refl)))
âŸ¦ â–·>eq[] âŸ§Ctx~ = {!  !}
âŸ¦ [id] âŸ§Ctx~ = refl
âŸ¦ [][] âŸ§Ctx~ = refl

âŸ¦ rfl~              âŸ§Ty~ = refl
âŸ¦ sym~ A~           âŸ§Ty~ = sym[]á´¾ âŸ¦ A~ âŸ§Ty~
âŸ¦ Aâ‚â‚‚~ âˆ™~ Aâ‚‚â‚ƒ~      âŸ§Ty~ = âŸ¦ Aâ‚â‚‚~ âŸ§Ty~ âˆ™[]á´¾ âŸ¦ Aâ‚‚â‚ƒ~ âŸ§Ty~
âŸ¦ coh               âŸ§Ty~ = coh[]á´¾
âŸ¦ ğ”¹ {Î“~ = Î“~}       âŸ§Ty~ = ğ”¹â‰¡ âŸ¦ Î“~ âŸ§Ctx~
âŸ¦ Î  {Î“~ = Î“~} A~ B~ âŸ§Ty~ = Î â‰¡ âŸ¦ Î“~ âŸ§Ctx~ âŸ¦ A~ âŸ§Ty~ âŸ¦ B~ âŸ§Ty~
âŸ¦ _[_] {Î“~ = Î“~} {Î”~ = Î”~} A~ Î´~ âŸ§Ty~ 
  = []Tâ‰¡ âŸ¦ Î“~ âŸ§Ctx~ âŸ¦ Î”~ âŸ§Ctx~ âŸ¦ A~ âŸ§Ty~ âŸ¦ Î´~ âŸ§Tms~
âŸ¦ if t~ A~ B~ âŸ§Ty~ = {!   !}

âŸ¦ ifTT              âŸ§Ty~ = refl
âŸ¦ ifFF              âŸ§Ty~ = refl
âŸ¦ Î []               âŸ§Ty~ = refl
âŸ¦ if[]              âŸ§Ty~ = refl
âŸ¦ ğ”¹[]               âŸ§Ty~ = refl
âŸ¦ [][]              âŸ§Ty~ = refl
âŸ¦ [id]              âŸ§Ty~ = refl

-- Specialisation of |coh[]á´¾| to assist with termination
cohTm : âˆ€ {âŸ¦tâŸ§ : âŸ¦TmâŸ§ {âŸ¦Î¨âŸ§ = âŸ¦Î¨âŸ§} âŸ¦Î“â‚âŸ§ âŸ¦Aâ‚âŸ§} {Î“â‰¡ : âŸ¦Î“â‚âŸ§ â‰¡á´¾ âŸ¦Î“â‚‚âŸ§} 
          {Aâ‰¡ : âŸ¦Aâ‚âŸ§ â‰¡[ Tyâ‰¡ Î“â‰¡ ]â‰¡á´¾ âŸ¦Aâ‚‚âŸ§} 
      â†’ âŸ¦tâŸ§ â‰¡[ Tmâ‰¡ Î“â‰¡ Aâ‰¡ ]â‰¡á´¾ coeá´¾ (Tmâ‰¡ Î“â‰¡ Aâ‰¡) âŸ¦tâŸ§
cohTm {Î“â‰¡ = refl} {Aâ‰¡ = refl} = refl

call-TTâ‰¡ : âˆ€ {âŸ¦tâŸ§ : âŸ¦TmâŸ§ {âŸ¦Î¨âŸ§ = âŸ¦Î¨âŸ§} âŸ¦Î“âŸ§ âŸ¦ğ”¹âŸ§}  {âŸ¦AâŸ§}
             {âŸ¦uâŸ§ : âŸ¦TmâŸ§ (âŸ¦â–·>eqâŸ§ âŸ¦Î“âŸ§ _ _) (âŸ¦[]TâŸ§ âŸ¦AâŸ§ âŸ¦wkeqâŸ§)} 
             {âŸ¦vâŸ§ : âŸ¦TmâŸ§ (âŸ¦â–·>eqâŸ§ âŸ¦Î“âŸ§ _ _) (âŸ¦[]TâŸ§ âŸ¦AâŸ§ âŸ¦wkeqâŸ§)} 
             {âŸ¦Î´âŸ§ : âŸ¦TmsâŸ§ {âŸ¦Î¦âŸ§ = âŸ¦Î¦âŸ§} âŸ¦Î”âŸ§ 
                          (âŸ¦[]CâŸ§ âŸ¦Î“âŸ§ (âŸ¦wkğ’®âŸ§ {âŸ¦AâŸ§ = âŸ¦AâŸ§} {âŸ¦tâŸ§ = âŸ¦tâŸ§}))} 
             (tâ‰¡ : âŸ¦[]tâŸ§ âŸ¦tâŸ§ (âŸ¦â¨¾âŸ§ {âŸ¦Î“âŸ§ = âŸ¦Î“âŸ§} (âŸ¦âŒœâŒğ’®âŸ§ {âŸ¦Î“âŸ§ = âŸ¦Î“âŸ§} âŸ¦wkğ’®âŸ§) âŸ¦Î´âŸ§) 
                 â‰¡á´¾ âŸ¦TTâŸ§)
             â†’ âŸ¦[]tâŸ§ (âŸ¦callâŸ§ {âŸ¦uâŸ§ = âŸ¦uâŸ§} {âŸ¦vâŸ§ = âŸ¦vâŸ§}) âŸ¦Î´âŸ§  
             â‰¡á´¾ âŸ¦[]tâŸ§ âŸ¦uâŸ§ (âŸ¦â¨¾âŸ§ {âŸ¦Î“âŸ§ = âŸ¦â–·>eqâŸ§ âŸ¦Î“âŸ§ âŸ¦tâŸ§ _}
                      (âŸ¦âŒœâŒğ’®âŸ§ {âŸ¦Î“âŸ§ = âŸ¦â–·>eqâŸ§ âŸ¦Î“âŸ§ âŸ¦tâŸ§ _} (âŸ¦wkğ’®âŸ§ )) 
                      (âŸ¦,eqâŸ§ {âŸ¦Î“âŸ§ = âŸ¦[]CâŸ§ âŸ¦Î“âŸ§ âŸ¦wkğ’®âŸ§} 
                             {âŸ¦tâŸ§ = âŸ¦[]tâŸ§ âŸ¦tâŸ§ (âŸ¦âŒœâŒğ’®âŸ§ âŸ¦wkğ’®âŸ§)} âŸ¦Î´âŸ§ tâ‰¡))
call-TTâ‰¡ {âŸ¦Î´âŸ§ = âŸ¦Î´âŸ§} tâ‰¡ 
  = funextá´¾ Î» Ï‡ â†’ funextá´¾ Î» Ï â†’ 
      let (Ï†â€² Î£, (f Î£, fTT Î£, fFF)) = âŸ¦Î´âŸ§ .fst Ï‡
          Ïâ€² = âŸ¦Î´âŸ§ .snd Ï
      in unbox (fTT Ïâ€² (Tmâ‰¡-inst tâ‰¡))

call-FFâ‰¡ : âˆ€ {âŸ¦tâŸ§ : âŸ¦TmâŸ§ {âŸ¦Î¨âŸ§ = âŸ¦Î¨âŸ§} âŸ¦Î“âŸ§ âŸ¦ğ”¹âŸ§}  {âŸ¦AâŸ§}
             {âŸ¦uâŸ§ : âŸ¦TmâŸ§ (âŸ¦â–·>eqâŸ§ âŸ¦Î“âŸ§ _ _) (âŸ¦[]TâŸ§ âŸ¦AâŸ§ âŸ¦wkeqâŸ§)} 
             {âŸ¦vâŸ§ : âŸ¦TmâŸ§ (âŸ¦â–·>eqâŸ§ âŸ¦Î“âŸ§ _ _) (âŸ¦[]TâŸ§ âŸ¦AâŸ§ âŸ¦wkeqâŸ§)} 
             {âŸ¦Î´âŸ§ : âŸ¦TmsâŸ§ {âŸ¦Î¦âŸ§ = âŸ¦Î¦âŸ§} âŸ¦Î”âŸ§ 
                          (âŸ¦[]CâŸ§ âŸ¦Î“âŸ§ (âŸ¦wkğ’®âŸ§ {âŸ¦AâŸ§ = âŸ¦AâŸ§} {âŸ¦tâŸ§ = âŸ¦tâŸ§}))} 
             (tâ‰¡ : âŸ¦[]tâŸ§ âŸ¦tâŸ§ (âŸ¦â¨¾âŸ§ {âŸ¦Î“âŸ§ = âŸ¦Î“âŸ§} (âŸ¦âŒœâŒğ’®âŸ§ {âŸ¦Î“âŸ§ = âŸ¦Î“âŸ§} âŸ¦wkğ’®âŸ§) âŸ¦Î´âŸ§) 
                 â‰¡á´¾ âŸ¦FFâŸ§)
             â†’ âŸ¦[]tâŸ§ (âŸ¦callâŸ§ {âŸ¦uâŸ§ = âŸ¦uâŸ§} {âŸ¦vâŸ§ = âŸ¦vâŸ§}) âŸ¦Î´âŸ§  
             â‰¡á´¾ âŸ¦[]tâŸ§ âŸ¦vâŸ§ (âŸ¦â¨¾âŸ§ {âŸ¦Î“âŸ§ = âŸ¦â–·>eqâŸ§ âŸ¦Î“âŸ§ âŸ¦tâŸ§ _}
                      (âŸ¦âŒœâŒğ’®âŸ§ {âŸ¦Î“âŸ§ = âŸ¦â–·>eqâŸ§ âŸ¦Î“âŸ§ âŸ¦tâŸ§ _} (âŸ¦wkğ’®âŸ§ )) 
                      (âŸ¦,eqâŸ§ {âŸ¦Î“âŸ§ = âŸ¦[]CâŸ§ âŸ¦Î“âŸ§ âŸ¦wkğ’®âŸ§} 
                             {âŸ¦tâŸ§ = âŸ¦[]tâŸ§ âŸ¦tâŸ§ (âŸ¦âŒœâŒğ’®âŸ§ âŸ¦wkğ’®âŸ§)} âŸ¦Î´âŸ§ tâ‰¡))
call-FFâ‰¡ {âŸ¦Î´âŸ§ = âŸ¦Î´âŸ§} tâ‰¡ 
  = funextá´¾ Î» Ï‡ â†’ funextá´¾ Î» Ï â†’ 
      let (Ï†â€² Î£, (f Î£, fTT Î£, fFF)) = âŸ¦Î´âŸ§ .fst Ï‡
          Ïâ€² = âŸ¦Î´âŸ§ .snd Ï
      in unbox (fFF Ïâ€² (Tmâ‰¡-inst tâ‰¡))

âŸ¦ rfl~         âŸ§Tm~ = refl
âŸ¦ sym~ t~      âŸ§Tm~ = sym[]á´¾ âŸ¦ t~ âŸ§Tm~
âŸ¦ tâ‚â‚‚~ âˆ™~ tâ‚‚â‚ƒ~ âŸ§Tm~ = âŸ¦ tâ‚â‚‚~ âŸ§Tm~ âˆ™[]á´¾ âŸ¦ tâ‚‚â‚ƒ~ âŸ§Tm~

âŸ¦ coh {Î“~ = Î“~} {A~ = A~} âŸ§Tm~ = cohTm {Î“â‰¡ = âŸ¦ Î“~ âŸ§Ctx~} {Aâ‰¡ = âŸ¦ A~ âŸ§Ty~}

âŸ¦ Æ›_ {Î“~ = Î“~} {A~ = A~} {B~ = B~} t~   âŸ§Tm~ 
  = Æ›â‰¡ âŸ¦ Î“~ âŸ§Ctx~ âŸ¦ A~ âŸ§Ty~ âŸ¦ B~ âŸ§Ty~ âŸ¦ t~ âŸ§Tm~
âŸ¦ Æ›â»Â¹_ {Î“~ = Î“~} {A~ = A~} {B~ = B~} t~ âŸ§Tm~ 
  = Æ›â»Â¹â‰¡ âŸ¦ Î“~ âŸ§Ctx~ âŸ¦ A~ âŸ§Ty~ âŸ¦ B~ âŸ§Ty~ âŸ¦ t~ âŸ§Tm~
âŸ¦ Ï€â‚‚ Î´~        âŸ§Tm~ = {!   !}
âŸ¦ TT Î“~        âŸ§Tm~ = TTâ‰¡ âŸ¦ Î“~ âŸ§Ctx~
âŸ¦ FF Î“~        âŸ§Tm~ = FFâ‰¡ âŸ¦ Î“~ âŸ§Ctx~
âŸ¦ t~ [ Î´~ ]    âŸ§Tm~ = {!   !}
âŸ¦ Ï€â‚‚eq {b = true}  Î´ âŸ§Tm~ with âŸ¦ Î´ âŸ§Tms
... | âŸ¦Î´âŸ§ = funextá´¾ Î» Ï‡ â†’ funextá´¾ Î» Ï â†’ âŸ¦Î´âŸ§ .snd Ï .snd .unbox
âŸ¦ Ï€â‚‚eq {b = false}  Î´ âŸ§Tm~ with âŸ¦ Î´ âŸ§Tms
... | âŸ¦Î´âŸ§ = funextá´¾ Î» Ï‡ â†’ funextá´¾ Î» Ï â†’ âŸ¦Î´âŸ§ .snd Ï .snd .unbox
âŸ¦ TT[]               âŸ§Tm~ = refl
âŸ¦ FF[]               âŸ§Tm~ = refl
âŸ¦ Æ›[]                âŸ§Tm~ = refl
âŸ¦ [id]               âŸ§Tm~ = refl
âŸ¦ [][]               âŸ§Tm~ = refl
âŸ¦ Î²                  âŸ§Tm~ = refl
âŸ¦ Î·                  âŸ§Tm~ = refl
âŸ¦ Ï€â‚‚,                âŸ§Tm~ = refl
âŸ¦ Ï€â‚‚â¨¾                âŸ§Tm~ = refl
âŸ¦ callTT {Î´ = Î´} t~  âŸ§Tm~ = call-TTâ‰¡ {âŸ¦Î´âŸ§ = âŸ¦ Î´ âŸ§Tms} âŸ¦ t~ âŸ§Tm~
âŸ¦ callFF {Î´ = Î´} t~  âŸ§Tm~ = call-FFâ‰¡ {âŸ¦Î´âŸ§ = âŸ¦ Î´ âŸ§Tms} âŸ¦ t~ âŸ§Tm~

âŸ¦ rfl~              âŸ§Tms~ = refl
âŸ¦ sym~ Î´~           âŸ§Tms~ = sym[]á´¾ âŸ¦ Î´~ âŸ§Tms~
âŸ¦ Î´â‚â‚‚~ âˆ™~ Î´â‚‚â‚ƒ~      âŸ§Tms~ = âŸ¦ Î´â‚â‚‚~ âŸ§Tms~ âˆ™[]á´¾ âŸ¦ Î´â‚‚â‚ƒ~ âŸ§Tms~
âŸ¦ coh               âŸ§Tms~ = coh[]á´¾
âŸ¦ Îµ                 âŸ§Tms~ = {!   !}
âŸ¦ Î´~ , t~           âŸ§Tms~ = {!   !}
âŸ¦ ,eq~ Î´~           âŸ§Tms~ = {!   !}
âŸ¦ id                âŸ§Tms~ = {!   !}
âŸ¦ Î´~ â¨¾ Ïƒ~           âŸ§Tms~ = {!   !}
âŸ¦ Ï€â‚ A~ Î´~          âŸ§Tms~ = {!   !}
âŸ¦ Ï€â‚eq t~ Î´~        âŸ§Tms~ = {!   !}
âŸ¦ ÎµÎ·                âŸ§Tms~ = {!!}
âŸ¦ ,Î·                âŸ§Tms~ = refl
âŸ¦ ,eqÎ· {b = true}   âŸ§Tms~ = refl
âŸ¦ ,eqÎ· {b = false}  âŸ§Tms~ = refl
âŸ¦ Ï€â‚,               âŸ§Tms~ = refl
âŸ¦ Ï€â‚eq, {b = false} âŸ§Tms~ = refl
âŸ¦ Ï€â‚eq, {b = true}  âŸ§Tms~ = refl
âŸ¦ Ï€â‚â¨¾               âŸ§Tms~ = refl
âŸ¦ Ï€â‚eqâ¨¾             âŸ§Tms~ = refl
âŸ¦ idâ¨¾               âŸ§Tms~ = refl
âŸ¦ â¨¾id               âŸ§Tms~ = refl
âŸ¦ â¨¾â¨¾                âŸ§Tms~ = refl
âŸ¦ ,â¨¾                âŸ§Tms~ = refl
âŸ¦ ,eqâ¨¾ {b = true}   âŸ§Tms~ = refl
âŸ¦ ,eqâ¨¾ {b = false}  âŸ§Tms~ = refl
âŸ¦ wkğ’®               âŸ§Tms~ = {!!}
âŸ¦ wkâ¨¾Ï€â‚             âŸ§Tms~ = {!!}
âŸ¦ wkâ¨¾Ï€â‚eq           âŸ§Tms~ = {!!}
